---
title: Notas de la versión de Magento Open Source 2.4.2
description: Obtenga información sobre las nuevas funciones, mejoras, correcciones de errores y problemas conocidos de la versión de Magento Open Source 2.4.2.
exl-id: 01e90bcb-d43c-4daa-9669-44e3370102af
source-git-commit: 95ffff39d82cc9027fa633dffedf15193040802d
workflow-type: tm+mt
source-wordcount: '13940'
ht-degree: 0%

---

# Notas de la versión de Magento Open Source 2.4.2

Magento Open Source 2.4.2 incorpora mejoras en el rendimiento y la seguridad, además de mejoras significativas en la plataforma. Las mejoras de seguridad incluyen la ampliación de la compatibilidad con `SameSite` para todas las cookies. Ahora se admiten Elasticsearch 7.9.x y Redis 6.x.

Esta versión incluye más de 280 nuevas correcciones del código principal y 35 mejoras de seguridad. Incluye la resolución de casi 290 problemas de GitHub por parte de los miembros de nuestra comunidad. Estas contribuciones de la comunidad van desde una limpieza menor del código principal hasta mejoras significativas en GraphQL.

Todos los problemas conocidos identificados en 2.4.1 se han corregido en esta versión.

{{bics}}

## Aplicar `AC-3022.patch` para seguir ofreciendo DHL como transportista

DHL ha introducido la versión de esquema 6.2 y dejará de utilizar la versión de esquema 6.0 en un futuro próximo. Adobe Commerce 2.4.4 y las versiones anteriores compatibles con la integración de DHL solo admiten la versión 6.0. Los comerciantes que implementen estas versiones deben aplicar `AC-3022.patch` lo antes posible para seguir ofreciendo DHL como transportista. Consulte la [Aplicar un parche para seguir ofreciendo DHL como transportista](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier) Artículo de Knowledge Base para obtener información sobre cómo descargar e instalar el parche.

## Parche de seguridad disponible

Los comerciantes ahora pueden instalar correcciones de seguridad urgentes sin aplicar los cientos de correcciones y mejoras funcionales que ofrece una versión trimestral completa (por ejemplo, 2.4.1-p1). El parche 2.4.0.12 (Composer package 2.4.1-p1) es un parche de seguridad que proporciona correcciones para vulnerabilidades que se han identificado en nuestra versión trimestral anterior, 2.4.1. Todas las correcciones rápidas aplicadas a la versión 2.4.1 se incluyen en este parche de seguridad. (A) *corrección rápida* proporciona una corrección de una versión publicada que soluciona un problema o error específico).

Para obtener información general sobre los parches de seguridad, consulte [Presentación de la nueva versión del parche de seguridad](https://community.magento.com/t5/Magento-DevBlog/Introducing-the-New-Security-Patch-Release/ba-p/141287). Para obtener instrucciones sobre cómo descargar y aplicar parches de seguridad (incluido el parche 2.4.1-p1), consulte [Instalación local de inicio rápido](../../../installation/composer.md). Los parches de seguridad solo incluyen correcciones de errores de seguridad, no las mejoras de seguridad adicionales que se incluyen en el parche completo.

## Otra información de la versión

Aunque el código de estas funciones está empaquetado con versiones trimestrales , varios de estos proyectos (por ejemplo, Progressive Web Application (PWA) Studio) también se publican de forma independiente. Las correcciones de errores para estos proyectos se documentan en la información de versión independiente y específica del proyecto que está disponible en la documentación de cada proyecto.

## Características destacadas

Busque los siguientes aspectos destacados en esta versión.

### Mejoras sustanciales de seguridad

Esta versión incluye más de 35 correcciones de seguridad y mejoras de seguridad de la plataforma. Todas las correcciones de seguridad se han adaptado a 2.4.1-p1 y 2.3.6-p1.

#### Más de 35 mejoras de seguridad que ayudan a cerrar las vulnerabilidades de ejecución de código remoto (RCE) y ejecución de scripts en sitios múltiples (XSS)

Hasta la fecha no se han producido ataques confirmados relacionados con estos problemas. Sin embargo, es posible que se aprovechen ciertas vulnerabilidades para acceder a la información de los clientes o hacerse cargo de las sesiones de administrador. La mayoría de estos problemas requieren que un atacante obtenga acceso primero al administrador. Como resultado, le recordamos que tome todas las medidas necesarias para proteger a su administrador, incluidas, entre otras, las siguientes medidas: inclusión en la lista de permitidos de IP, [autenticación de doble factor](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html), el uso de una VPN, el uso de una ubicación única en lugar de `/admin`y una buena higiene de las contraseñas. Consulte [Boletín de seguridad del Adobe](https://helpx.adobe.com/security/products/magento/apsb21-08.html) para una discusión de estos problemas fijos.

#### Mejoras de seguridad adicionales

Las mejoras de seguridad para esta versión incluyen:

* Todas las cookies principales ahora admiten el `SameSite` atributo.

* La aplicación ahora muestra mensajes que identifican contenido potencialmente malicioso en los campos de descripción de productos y categorías cuando el usuario intenta guardar valores en estos campos.

* Las operaciones del sistema de archivos en todos los componentes se han estandarizado y reforzado para evitar cargas malintencionadas.

* Se han corregido las infracciones de la Política de seguridad de contenido principal (CSP).

{{cve-notice}}

### Mejoras de infraestructura

Esta versión contiene mejoras en la calidad principal, que mejoran la calidad del marco de trabajo y estas áreas funcionales: Cuenta de cliente, Catálogo, CMS, OMS, Importación/Exportación, Promociones y objetivos, y Carro y cierre de compra.

### Mejoras de Platform

* [**Ahora se admite el Elasticsearch 7.9.x**](../../../installation/system-requirements.md). Aunque se recomienda ejecutar el Elasticsearch 7.9.x, la versión 2.4.x sigue siendo compatible con el Elasticsearch 7.4.x. <!-- MC-36867-->

* 2.4.2 se ha ensayado con [Barniz 6.4](../../../installation/system-requirements.md). La versión 2.4.x sigue siendo compatible con Varnish 6.x.

* [**Ahora se admite Redis 6.x**](../../../installation/system-requirements.md). La versión 2.4.x sigue siendo compatible con Redis 5.x. <!-- MC-34853-->

* 2.4.2 ahora es compatible con **Composer 2.x**. Recomendamos a los comerciantes migrar a Composer 2.x. Aunque puede instalar esta versión con Composer 1.x, Composer 1.x llegará pronto al final de su vida útil. Para obtener una descripción general de las funciones de Composer 2.x, consulte [¡Composer 2.0 ya está disponible!](https://blog.packagist.com/composer-2-0-is-now-available/)

La capacidad de configurar una instalación para utilizar una base de datos dividida ha quedado obsoleta en esta versión. Los comerciantes que actualmente utilizan bases de datos divididas deben empezar a planificar la reversión a una sola base de datos o la migración a ella, o utilizar un método alternativo. Consulte la [Obsolescencia de la funcionalidad de base de datos dividida en el Magento Open Source](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187) Publicación de DevBlog para obtener una descripción general de este problema.  Consulte [Revertir de una base de datos dividida a una única base de datos](../../../configuration/storage/revert-split-database.md) para obtener instrucciones de migración.

### Mejoras de rendimiento

Esta versión incluye mejoras de código que mejoran el rendimiento de la API y el tiempo de respuesta del administrador para implementaciones con catálogos grandes. Varias mejoras en la escalabilidad permiten que 2.4.2 admita de forma nativa catálogos complejos hasta 20 veces más grandes que en versiones anteriores.

### Integración de Adobe Stock

Esta versión incluye Adobe Stock Integration v2.1.1.

### GraphQL

Esta versión añade cobertura de GraphQL para las siguientes funciones:

* Se ha añadido la compatibilidad con [listas de comparación](https://devdocs.magento.com/guides/v2.4/graphql/queries/compare-list.html). Los compradores pueden [crear](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-compare-list.html) y [eliminar](https://devdocs.magento.com/guides/v2.4/graphql/mutations/delete-compare-list.html) listas de comparación, y [añadir](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-compare-list.html) y [quitar](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-products-from-compare-list.html) elementos a las listas de comparación. Además, los compradores que crean una lista de comparación como invitados pueden iniciar sesión como clientes y [conservar](https://devdocs.magento.com/guides/v2.4/graphql/mutations/assign-compare-list-to-customer.html) sus listas de comparación.

* Se ha añadido la [`generateCustomerTokenAsAdmin`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/generate-customer-token-as-admin.html) mutación y se ha actualizado el `Customer` objeto para admitir la asistencia de compra remota.

* Se ha agregado compatibilidad con la localización en todas las tiendas para admitir tareas como cambiar idiomas, carros de compras y monedas. <!-- MC-37801-->

* Se ha añadido apoyo a los sindicatos en GraphQL. [GitHub-29425](https://github.com/magento/magento2/issues/29425) <!-- ENGCOM-8291 -->

* El esquema de GraphQL se ha mejorado para optimizar la recuperación de datos de productos para productos configurables con muchas variantes. <!-- MC-36138-->

* Los ID de objeto de tipo entero se han quedado obsoletos en favor de `uid` atributos de tipo ID. <!-- MC-36346-->

* Se ha añadido la `staging` atribuir a [`ProductInterface`](https://devdocs.magento.com/guides/v2.4/graphql/interfaces/product-interface.html) y [`CategoryInterface`](https://devdocs.magento.com/guides/v2.4/graphql/interfaces/category-interface.html) para determinar si un producto está ensayado y ver su información de campaña asociada. <!-- MC-33897-->

Consulte la [Guía para desarrolladores de GraphQL](https://devdocs.magento.com/guides/v2.4/graphql/) para obtener más información sobre estas mejoras.

### PWA Studio

Esta versión de PWA Studio incluye:

* Internacionalización y localización. Venia ahora es compatible con varios idiomas y monedas.

* Se ha mejorado el marco de trabajo de extensibilidad para admitir cambios en el código mediante extensiones.

* Componentes iniciales para funciones relacionadas con Mi cuenta, como Lista de deseos, Pagos guardados, Libreta de direcciones e Historial de pedidos.

* Varias optimizaciones de rendimiento y correcciones de errores.

Para obtener información sobre mejoras y correcciones de errores, consulte [Versiones del PWA Studio](https://github.com/magento/pwa-studio/releases). Consulte [compatibilidad](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) para obtener una lista de versiones de PWA Studio y sus versiones compatibles.

### Galería de medios

**Nuevos recursos de roles para la galería de medios**. Esta versión proporciona a los comerciantes la capacidad de limitar el acceso de administrador solo a la galería de medios y de controlar quién puede realizar estas acciones:

* Insertar recursos de medios en el contenido

* Cargar recursos

* Editar detalles de recursos

* Eliminar recursos de la Galería de medios

* Administrar estructura de carpetas.

**Imágenes optimizadas para la web en el contenido**. Los comerciantes ahora pueden utilizar [representación de imágenes optimizadas para la web](https://docs.magento.com/user-guide/cms/media-gallery-image-optimization.html) en el contenido en lugar de imágenes de alta resolución. La imagen original permanece sin modificar en la Galería multimedia y la representación de la imagen se genera dinámicamente cuando la imagen se inserta en el contenido.

### Marco de prueba funcional (MFTF)

MFTF 3.2.1 ya está disponible. Esta versión introduce tolerancia a errores tanto en las pruebas como en la generación de grupos de pruebas. Se describen mejoras adicionales y correcciones de errores en la [Registro de cambios del marco de prueba funcional](https://github.com/magento/magento2-functional-testing-framework/blob/develop/CHANGELOG.md).

### Extensiones desarrolladas por el proveedor

Consulte los siguientes artículos para obtener actualizaciones sobre las funciones y los cambios de esta versión:

* [Amazon Pay](https://docs.magento.com/user-guide/payment/amazon-pay.html)

* [Braintree](https://docs.magento.com/user-guide/payment/braintree.html)

* [dotdigital Engagement Cloud](https://docs.magento.com/user-guide/marketing/dotdigital/engagement-cloud.html)

* [Klarna](https://docs.magento.com/user-guide/payment/klarna.html)

* [Vertex Cloud](https://docs.magento.com/user-guide/tax/vertex.html)

* [Yotpo Reseñas de productos](../../../upgrade/modules/upgrade.md)

### Mejoras de compatibilidad con AWS S3

Se ha mejorado la compatibilidad con Amazon Simple Storage Service (AWS S3) para incluir compatibilidad con:

* Almacenamiento de objetos y extensibilidad futura

* [Almacenamiento de archivos multimedia](../../../configuration/remote-storage/remote-storage.md) en AWS S3

## Problemas solucionados

Hemos corregido cientos de problemas en el código principal 2.4.2.

### Instalación, actualización e implementación

<!-- MC-38429-->

* La capacidad de configurar una instalación para utilizar una base de datos dividida ha quedado obsoleta en esta versión. Consulte la [Obsolescencia de la funcionalidad de base de datos dividida en el Magento Open Source](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187) Publicación de DevBlog.

<!-- MC-36472-->

* Los comerciantes ahora pueden actualizar correctamente una implementación de código abierto que ejecuta MySQL 8.x a una implementación de comercio. Anteriormente, la aplicación arrojaba una excepción cuando `AUTO_INCREMENT` valores revertidos a valores iniciales para todas las tablas donde `row_id` se agregó durante la actualización.

<!-- ENGCOM-7280 -->

* La aplicación ahora muestra un mensaje de error que identifica la ruta que se utilizó para crear el parche si se produce un error al ejecutar `bin/magento/setup:db:generate-patch`. [GitHub-27523](https://github.com/magento/magento2/issues/27523)

<!-- ENGCOM-8029 -->

* `block_html`, `full_page`, y `layout` las cachés ahora están desactivadas como se espera después de `bin/magento/setup:upgrade` ejecución.  [GitHub-28186](https://github.com/magento/magento2/issues/28186)

<!-- ENGCOM-8184 -->

* La versión mínima requerida de PHP en `bootstrap.php` se ha actualizado. [GitHub-30004](https://github.com/magento/magento2/issues/30004)

<!-- MC-38788-->

* Ahora puede ejecutar `bin/magento/setup:upgrade` después de instalar los datos de ejemplo. Anteriormente, cuando intentaba ejecutar `bin/magento/setup:upgrade`, la aplicación mostraba este error: `unable to apply data patch magento\catalogrulesampledata\setup\patch\data\installcatalogrulesampledata for module magento_catalogrulesampledata`. La aplicación también mostraba este error en el registro del sistema: `main.ERROR: Sample Data error: Unable to unserialize value. Error: Syntax error`. [GitHub-30685](https://github.com/magento/magento2/issues/30685)

<!-- MC-36785-->

* Ahora puede establecer una clave de API de YouTube desde la línea de comandos según lo esperado. Anteriormente, la aplicación devolvía este error al intentar ejecutar `bin/magento config:sensitive:set catalog/product_video/youtube_api_key`: `There are no sensitive configurations to fill`.

<!-- ENGCOM-8163 -->

* La aplicación ahora respeta el `maxMessages` valores definidos en `queue_consumer.xml`. Anteriormente, la aplicación solo utilizaba los valores de configuración de implementación. [GitHub-29522](https://github.com/magento/magento2/issues/29522)

<!-- ENGCOM-8243 -->

* La generación de URL para un nuevo almacén ahora funciona como se espera cuando se crea el almacén con `bin/magento setup:config:import`. Anteriormente, las reescrituras de URL no se generaban en entornos de producción. [GitHub-30025](https://github.com/magento/magento2/issues/30025)

<!-- ENGCOM-8230 -->

* La aplicación ya no genera un error cuando intenta cambiar `backend-frontname` uso del `ssh` contenedor después de instalar el Magento Open Source. [GitHub-26762](https://github.com/magento/magento2/issues/26762)

<!-- ENGCOM-8230 -->

* La aplicación ya no muestra esta pregunta cuando se ejecuta `bin/magento setup:install` para conectarse a una base de datos existente: `Overwrite the existing configuration for db-ssl-verify?[Y/n]`. [GitHub-29612](https://github.com/magento/magento2/issues/29612)

### Integración de Adobe Stock

<!-- ENGCOM-8020-->

* Se ha agregado compatibilidad para leer `exif_image.png` o `exif-image.jpeg` metadatos. [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- ENGCOM-8194 8094 8147-->

* El contenido que se muestra al hacer clic en el marcador Vista predeterminada de la Galería multimedia ya no se filtra. Anteriormente, la vista predeterminada contenía un filtro que se aplicaba desde `url-filter` aplicador. [GitHub-1813](https://github.com/magento/adobe-stock-integration/issues/1813), [GitHub-1789](https://github.com/magento/adobe-stock-integration/issues/1789), [GitHub-1780](https://github.com/magento/adobe-stock-integration/issues/1780)

<!-- ENGCOM-8070 -->

* Se ha eliminado la lógica del controlador WYSIWYG OnInsert (`Magento\Cms\Controller\Adminhtml\Wysiwyg\Images\OnInsert::execute()`) y se añade a `Model\Wysiwyg\Images\PrepareImage::execute()` modelo. [GitHub-1504](https://github.com/magento/adobe-stock-integration/issues/1504)

<!-- ENGCOM-8081 -->

* La emulación de área se ha eliminado del `media-content:sync` comando (`\Magento\MediaContentSynchronization\Console\Command\Synchronize::execute`). [GitHub-1784](https://github.com/magento/adobe-stock-integration/issues/1784)

### Analytics

<!-- MC-37137-->

* Ahora, los informes avanzados funcionan según lo esperado en varios entornos del mismo dominio. Anteriormente, los archivos CSV generados por los informes avanzados fallaban porque las comillas dobles se escapaban con barras invertidas en lugar de con otra comilla doble, como exige el estándar CSV RFC4180.

<!-- MC-35996-->

* El `analytics_collect_data` El trabajo de se ejecuta ahora correctamente cuando se utiliza el puerto predeterminado o no predeterminado para conectarse a MySQL en `env.php`. Anteriormente, `analytics_collect_data` ha devuelto un error al usar el puerto no predeterminado.

<!-- MC-35407-->

* Archivos CSV generados por `analytics_collect_data` ahora se han escapado correctamente. Anteriormente, estos archivos no se generaban con el escape correcto, lo que impedía la generación de informes de inventario.

### Braintree

* Los compradores ahora pueden usar Apple Pay para realizar correctamente un pedido de productos virtuales. Anteriormente, la aplicación arrojaba este error: `There are no shipping methods available for you right now. Please try again or use an alternative payment method`.

* El método de pago predeterminado PayPal Express Checkout funciona ahora según lo esperado con el método de pago con tarjeta de crédito del Braintree. Anteriormente, la aplicación no mostraba el **PayPal** botón cuando el método de pago con tarjeta de crédito de Braintree estaba activado.

### Paquete de productos

<!-- MC-34063-->

* La aplicación ya no establece los precios de los artículos secundarios del paquete de precio fijo entre comillas.

<!-- MC-38050-->

* La clasificación de precios ahora funciona como se espera cuando los productos agrupados incluyen productos sin existencias. Anteriormente, al ordenar el precio en orden descendente, no se mostraban los productos en orden descendente.

<!-- MC-38576-->

* La aplicación ahora aplica automáticamente una cantidad predeterminada de 1 para las opciones de producto del paquete cuando existen muchas opciones. Anteriormente, los comerciantes tenían que asignar manualmente una cantidad predeterminada a cada opción.

<!-- ENGCOM-8159 -->

* La página de creación de facturas de pedido ahora muestra los productos secundarios de los productos agrupados según lo esperado. [GitHub-27350](https://github.com/magento/magento2/issues/27350)

<!-- MC-38460 -->

* La aplicación ahora asigna precios de producto correctos cuando se reordenan productos simples que forman parte de un paquete de productos con un precio personalizado. Anteriormente, al establecer un precio personalizado en un producto agrupado, se producían precios incorrectos en los productos simples adjuntos cuando se reordenaban. [GitHub-30343](https://github.com/magento/magento2/issues/30343)

<!-- MC-30348 -->

* POST de llamada `/V1/order/{orderId}/ship` para enviar un pedido que contiene un paquete de productos, ahora el pedido se marca como completado según lo esperado. Anteriormente, la aplicación mostraba este mensaje de error: `You can't create a shipment without products`. [GitHub-9762](https://github.com/magento/magento2/issues/9762)

### Carro y cierre de compra

<!-- MC-34264-->

* El estimador del método de envío ahora funciona como se espera cuando los atributos de dirección personalizados están presentes en la etapa de envío del flujo de trabajo de cierre de compra. Anteriormente, la aplicación mostraba este mensaje de error: `{"message":"Error occurred during \"custom_attributes\" processing. A custom attribute is specified with a missing attribute code. Verify the code and try again."}` [GitHub-27505](https://github.com/magento/magento2/issues/27505)

<!-- MC-35783-->

* La aplicación ahora muestra el `You have no items in your shopping cart` Mensaje en el minicarrito como se espera cuando un comprador elimina el único artículo del carro de compras. Anteriormente, los datos del carro de compras no se actualizaban para `checkout/cart/removeFailed` cuando un comprador quitó el solo artículo y la aplicación mostró este mensaje: `1 product requires your attention`.

<!-- MC-36088-->

* La aplicación ya no muestra el coste de envío de un pedido para un método de envío no aplicable. Anteriormente, la aplicación mostraba un precio de 0 para un método de envío no aplicable en el flujo de trabajo de cierre de compra.

<!-- MC-36598-->

* La dirección de facturación predeterminada de un cliente ahora está seleccionada cuando el **Mi dirección de facturación y envío es la misma** La casilla de verificación del flujo de trabajo de cierre de compra está desactivada.

<!-- MC-37351-->

* El contenido del carro de compras ya no se pierde cuando un comprador cambia de una tienda a otra en un dominio diferente.

<!-- MC-38000-->

* Los compradores ahora pueden completar correctamente un pedido utilizando Desproteger con varias direcciones cuando se utilizan varios métodos de envío. Anteriormente, la aplicación mostraba este error: `There has been an error processing your request`. [GitHub-30197](https://github.com/magento/magento2/issues/30197)

<!-- MC-38048-->

* La aplicación ahora muestra el país predeterminado correcto en la página de envío del flujo de trabajo de cierre de compra cuando el comprador cambia la vista de la tienda desde el carro de compras.

<!-- MC-38309-->

* La aplicación ahora excluye la sesión actual al limpiar las sesiones de los clientes después de un restablecimiento de contraseña posterior al cierre de sesión cuando un comprador invitado inicia sesión. Anteriormente, la aplicación vaciaba el carro de compras cuando el comprador restablecía su contraseña.

<!-- MC-36884-->

* La aplicación ahora muestra el país predeterminado correcto para una vista de tienda cuando un comprador cambia la vista de la tienda en el carro de compras. Anteriormente, cuando se cambiaba la vista de la tienda en el carro de compras, el país predeterminado era incorrecto.

<!-- MC-38746-->

* Llamadas redundantes a `/rest/V1/guest-carts/cart_id/totals-information` Se han eliminado los extremos del carro de compras, lo que ha mejorado el rendimiento del carro de compras. Anteriormente, cuando un comprador agregaba un producto al carro de compras y posteriormente lo veía, la aplicación llamaba a `collectAddressTotals` método varias veces.

<!-- MC-38833-->

* La aplicación ya no muestra el **Región** para un país en el flujo de trabajo de cierre de compra cuando **Permitir la selección del estado si es opcional para el país** La configuración está deshabilitada. [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- MC-38813-->

* La aplicación ya no repite una dirección de envío en el flujo de trabajo de cierre de compra de la tienda cuando se vuelve a solicitar un pedido al administrador.

<!-- MC-38814-->

* Se corrigieron problemas con el diseño de `AdminMediaGalleryInsertLargeImageFileSizeTest`.

<!-- MC-37321-->

* Todos los registros nuevos de la `quote` ahora se asigna un valor de 1 a la tabla para invitados en el `customer_is_guest field`. Anteriormente, a cada nuevo invitado que agregaba un producto al carro de compras se le asignaba un 0 en el`quote.customer_is_guest` field.

<!-- ENGCOM-8091 -->

* El **Enviar** botón de la sección Revisión y pagos del flujo de trabajo de cierre de compra que se ha movido a dentro de `<form id="purchaseorder-form"...></form>`, que hace posible el envío implícito del formulario sin alterar ningún JavaScript. [GitHub-27925](https://github.com/magento/magento2/issues/27925)

<!-- ENGCOM-8428 -->

* La aplicación ya no muestra el **Región** en el flujo de trabajo de cierre de compra cuando **Permitir la selección del estado si es opcional para el país** La configuración está deshabilitada. [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- ENGCOM-8442 -->

* La aplicación ahora actualiza correctamente el subtotal de artículos del carro de compras cuando un comprador hace clic en **Actualizar carro de compras** mientras se desprotege con varias direcciones. [GitHub-30408](https://github.com/magento/magento2/issues/30408)

<!-- ENGCOM-8283 -->

* La aplicación ya no genera una excepción cuando `config.xml` existen nodos para métodos de pago que no están instalados actualmente. Anteriormente, la aplicación arrojaba una excepción durante el cierre de compra. [GitHub-29555](https://github.com/magento/magento2/issues/29555)

<!-- ENGCOM-8215 -->

* La aplicación ahora procesa correctamente en el minicarrito los nombres de productos que contienen caracteres especiales. [GitHub-29075](https://github.com/magento/magento2/issues/29075)

<!-- ENGCOM-8308 -->

* La aplicación ahora establece el paquete de descuento correcto para la tarifa de tabla. Anteriormente, la aplicación no aplicaba una regla de carro de compras que estableciera un descuento en el carro de compras al calcular la tasa de tabla. [GitHub-30169](https://github.com/magento/magento2/issues/30169)

### Regla de precio del carro

* Las reglas de precios del carro de compras ahora se aplican según lo esperado cuando se calculan los subtotales de pedidos sin incorporar impuestos. El nuevo `Subtotal (Incl. Tax)` se ha añadido como una condición de regla de precio de carro de compras.

<!-- MC-37884-->

* La aplicación de una regla de precio con un cupón mediante GraphQL ahora funciona como se espera cuando la variable **Descuento de cantidad fija para todo el carro** se utiliza la acción.

### Catálogo

<!-- MC-34100-->

* La aplicación ahora muestra todos los productos reactivados en la tienda según lo esperado. Anteriormente, cuando un producto se deshabilitaba y luego se volvía a habilitar, la aplicación no mostraba el producto hasta que se borraba la caché de la página de Barniz o se volvía a indexar la tienda, porque la caché de la página no se invalidaba después de volver a habilitar un producto.

<!-- MC-37745-->

* La reindexación parcial de catálogos grandes ahora funciona según lo esperado. Anteriormente, los productos desaparecían aleatoriamente de la página de categoría de tienda durante la reindexación con `catalogsearch_fulltext` indexador parcial.

<!-- MC-35123-->

* Los compradores ahora pueden reordenar un pedido facturado de un producto con opciones personalizables según lo esperado. Anteriormente, la aplicación arrojaba este error cuando un comprador intentaba volver a comprar: `{"0":"The product's required option(s) weren't entered. Make sure the options are entered and try again`.

<!-- MC-35212-->

* Ahora puede establecer correctamente la variable **Diseño** en la página Diseño de categoría para **No hay actualizaciones de diseño**. Anteriormente, la aplicación volvía a **Categoría - Anchura completa** cuando asignó el **No hay actualizaciones de diseño** valor.

<!-- MC-35490-->

* Se han resuelto problemas con el orden de los productos en la tienda. Anteriormente, cuando la aplicación indexaba los precios de los productos, ocasionalmente establecía el `min_price` y `max_price` a 0 en el `catalog_product_index_price` , que afectaba al orden de los precios en la tienda.

<!-- MC-35608-->

* La aplicación ahora actualiza correctamente los atributos etiquetados como `Product Type`. Anteriormente, debido a que `product_type` se reservó en el código, la aplicación mostraba este mensaje cuando intentaba actualizar un `Product Type` atributo: `An attribute with the same code (product_type) already exists.`

<!-- MC-36214-->

* La aplicación ya no cambia la posición de un vídeo cargado en la sección Imágenes y vídeos de la página de detalles del producto al guardar el producto. Anteriormente, a la nueva posición de la imagen se le asignaba un valor de índice (posición en la lista) y, si las posiciones de imagen existentes no estaban alineadas con sus valores de índice, la nueva imagen se colocaba de forma incorrecta en la lista.

<!-- MC-36548-->

* El **Añadir al carro** ahora funciona según lo esperado siempre que la función **Añadir al carro** para hacer clic en. Anteriormente, si hacía clic en este botón varias veces mientras esperaba a que se cargara una página de producto, la aplicación arrojaba este error: `Invalid Form Key. Please refresh the page`.

<!-- MC-37006 36835-->

* La aplicación ya no vacía la caché de categorías cuando un comerciante añade o elimina productos desactivados de una categoría. Anteriormente, la aplicación vaciaba la caché para categorías relacionadas a pesar del estado del producto. También se quitó la asignación de categorías al guardar una categoría, lo que provocó el vaciado de la caché de categorías.

<!-- MC-37347-->

* Filtrado de productos de catálogo dentro de **Vista de todas las tiendas** ahora, el ámbito funciona correctamente. Anteriormente, los productos con un estado de `Enabled` o `Disabled` se mostraban en la cuadrícula mientras se filtraban solo los productos activados o desactivados.

<!-- MC-38038-->

* La reindexación parcial ya no da como resultado productos perdidos y categorías vacías.

<!-- MC-38315-->

* La reordenación ahora funciona según lo esperado cuando **Usar calendario JavaScript** está habilitado (**Tiendas** > **Configuración** > **Catálogo** > **Opciones personalizadas de fecha y hora**). Anteriormente, cuando esta configuración estaba habilitada, la aplicación mostraba este error cuando intentaba reordenar el pedido realizado anteriormente desde el administrador: `Please specify date required option(s)`.

<!-- MC-38719-->

* La aplicación ahora muestra la moneda correcta en implementaciones de varios sitios durante la creación de precios de nivel.

<!-- MC-38914-->

* Los atributos personalizados de imagen de producto ahora se escapan correctamente. El `data-src` tiene el mismo valor que `src` , tal como se esperaba. Anteriormente, los símbolos especiales de URL se evitaban.

<!-- MC-37665-->

* Al actualizar una categoría a través de la API de REST, ya no se desactiva la variable **Utilizar valor predeterminado** en los atributos Habilitar categoría, Incluir en el menú y Clave de URL.

<!-- MC-35363-->

* Al guardar una categoría, ahora se vacía solamente la memoria caché de bloques relacionada con esta categoría. Anteriormente, la aplicación vaciaba la caché de todos los bloques de categorías.

<!-- MC-30626-->

* El precio de una opción personalizada con un precio porcentual ahora se convierte según lo esperado en la moneda base de la tienda activa en implementaciones de varias tiendas. Anteriormente, el precio de una opción personalizada con un precio porcentual se convertía incorrectamente. [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- MC-38890-->

* La aplicación ahora vuelve a crear imágenes correctamente y estas imágenes son visibles en el administrador como se espera cada vez que un comerciante envía datos de la galería de medios mediante POST `rest/all/V1/products`. Anteriormente, la aplicación recreaba las imágenes pero las eliminaba cuando un comerciante enviaba datos de la galería de medios a través de un POST `rest/all/V1/products` si las imágenes se eliminaron en `pub/media` pero aún había registros en los medios que aún contenían registros para estas imágenes. Como resultado, el comerciante solo vio marcadores de posición en el Administrador porque las imágenes se crearon y eliminaron durante el proceso de actualización.

<!-- MC-36903-->

* Los registros ahora se eliminan según lo esperado cuando se anula la asignación de un elemento de un sitio web. Anteriormente, las imágenes se duplicaban cuando el POST `rest/all/V1/products` se ha ejecutado.

<!-- MC-38413-->

* El `/V1/categories/{categoryId}/products` La llamada de ahora devuelve una lista de todos los productos que pertenecen a la categoría principal según lo esperado. Anteriormente, si un producto pertenecía a más de una subcategoría de la categoría principal, la aplicación arrojaba este tipo de error: `Internal Error. Details are available in the application log file. Report ID: webapi-5f8579e37db54`.  [GitHub-30461](https://github.com/magento/magento2/issues/30461)

<!-- MC-32996-->

* El `/V1/products/attributes/:attributeCode/options` El punto de conexión REST ahora admite la actualización de una opción de atributo existente.

<!-- MC-30626 ENGCOM-8475-->

* El precio de una opción personalizada con un precio porcentual ahora se convierte según lo esperado en la moneda base de la tienda activa en implementaciones de varias tiendas. Anteriormente, el precio de una opción personalizada con un precio porcentual se convertía incorrectamente. [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- ENGCOM-8395 -->

* Los comerciantes ahora pueden guardar correctamente un nuevo atributo durante la creación del producto. Anteriormente, la aplicación no guardaba el atributo y redirigía al comerciante a la página de inicio de la vista de la tienda cuando intentaba guardarlo. [GitHub-30362](https://github.com/magento/magento2/issues/30362)

<!-- ENGCOM-7997 -->

* Las cuadrículas de productos de la **Ventas** > **Pedidos** y **Catálogo** > **Productos** Las páginas de ahora enumeran todas las tiendas relevantes, no solo la tienda creada más recientemente. [GitHub-29267](https://github.com/magento/magento2/issues/29267)

<!-- ENGCOM-6698 -->

* El repositorio de productos ahora utiliza `store_id` cuando esté disponible para guardar valores de atributo para un producto existente.  Anteriormente, la clase de repositorio de productos sobrescribía el ID de almacén de productos y siempre asignaba el ID de almacén predeterminado. [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### Regla de catálogo

<!-- MC-35065-->

* Las reglas de precios de catálogo ahora funcionan según lo esperado con opciones personalizadas en las páginas de detalles del producto. Anteriormente, los precios de los productos en esa página no reflejaban las reglas de precios de catálogo aplicables. [GitHub-22856](https://github.com/magento/magento2/issues/22856)

<!-- MC-34265-->

* Las cachés de productos y catálogos ahora caducan según lo programado. Anteriormente, las cachés caducaban a diario debido a `сron` se ejecutó el `catalogrule_apply_all` tarea una vez al día, que reindexaba todas las reglas de catálogo y los indexadores dependientes, y borraba la caché de todos los productos y categorías.

### Cleanup

#### Escritura y limpieza gramatical

<!-- ENGCOM-7967 -->

* Se ha revisado el título de la página Error de pedido para comprobar su precisión. Anteriormente, esta página se denominaba: **¡Recibimos su pedido!**.  [GitHub-29416](https://github.com/magento/magento2/issues/29416)

<!-- ENGCOM-8101 -->

* Se han eliminado espacios innecesarios en `app/code/Magento/Contact/view/frontend/templates/form.phtml`. [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-7716 -->

* Se ha corregido un error tipográfico en el mensaje de ayuda de `bin/magento/setup:config:set` subcomando.  [GitHub-28802](https://github.com/magento/magento2/issues/28802)

<!-- ENGCOM-8058 -->

* Se corrigió la gramática en el PHPDoc para `framework/Registry.php` archivo. [GitHub-29661](https://github.com/magento/magento2/issues/29661)

<!-- ENGCOM-8273 -->

* Se ha eliminado el espacio en blanco superfluo de `app/code/Magento/Catalog/Helper/Product/View.php`. [GitHub-30601](https://github.com/magento/magento2/issues/30601)

<!-- ENGCOM-8181 -->

* Se ha corregido un error tipográfico en un nombre de función en `app/code/Magento/Ui/view/base/web/js/form/element/ui-select.js`. [GitHub-29987](https://github.com/magento/magento2/issues/29987)

<!-- ENGCOM-8478 -->

* Se ha corregido la pluralización de &quot;item&quot; en el minicarrito y el resumen del pedido de cierre de compra. [GitHub-29920](https://github.com/magento/magento2/issues/29920)

<!-- ENGCOM-8309 -->

* Se han eliminado los espacios en blanco en los elementos en línea en los filtros de navegación por capas de marcado. [GitHub-30448](https://github.com/magento/magento2/issues/30448)

<!-- ENGCOM-8056 -->

* `rl` se ha corregido a `url` in  `\Magento\Framework\Filter\Template\Tokenizer\Parameter`. [GitHub-29185 ](https://github.com/magento/magento2/issues/29185)

#### Limpieza de código

<!-- MC-37922-->

* Un HTML extraño `<br>` se ha eliminado del área de mensaje Comprobar datos del  **Sistema**  >  **Importar** página.

<!-- ENGCOM-8028 -->

* `ChangeQuoteControl` se ha refactorizado. [GitHub-29673](https://github.com/magento/magento2/issues/29673)

<!-- ENGCOM-8027 -->

* `AccessChangeQuoteControl` y sus pruebas unitarias se han refactorizado. [GitHub-29672](https://github.com/magento/magento2/issues/29672)

<!-- ENGCOM-8053 -->

* Se ha corregido el estilo de código de la declaración de tipo de valor devuelto en `app/code/Magento/Captcha/CustomerData/Captcha.php`. [GitHub-29712](https://github.com/magento/magento2/issues/29712)

<!-- ENGCOM-8288 -->

* Se ha corregido la posición de la lista de botones en la página Nuevo atributo.

<!-- ENGCOM-8315 -->

* Se ha añadido la clase de bloque correcta para el front-end `viewModel` ejemplo de referencia para `\Magento\Framework\View\Element\Template` clase. [GitHub-30450](https://github.com/magento/magento2/issues/30450)

<!-- ENGCOM-8090 -->

* Se ha eliminado un conjunto de campos redundante del formulario Regla de venta. [GitHub-29599](https://github.com/magento/magento2/issues/29599)

<!-- ENGCOM-8448 -->

* Se ha eliminado código innecesario del `hierarchy/edit.phtml` plantilla.

<!-- ENGCOM-8446 -->

* Comentario PHPdoc corregido en `app/code/Magento/CatalogImportExport/Model/Export/Product.php`. [GitHub-30833](https://github.com/magento/magento2/issues/30833)

<!-- ENGCOM-8277 -->

* La anotación docblock para `PublisherInterface` se ha corregido el mensaje. [GitHub-30190](https://github.com/magento/magento2/issues/30190)

<!-- ENGCOM-8264 -->

* Argumentos corregidos en `getStatusByState` método. [GitHub-30173](https://github.com/magento/magento2/issues/30173)

<!-- ENGCOM-8235 -->

* Descripción del método corregido en `app/code/Magento/Quote/Model/Cart/Totals/ItemConverter.php`. [GitHub-30125](https://github.com/magento/magento2/issues/30125)

<!-- ENGCOM-8242 -->

* Se han eliminado asignaciones de variables redundantes en la misma línea en varios archivos. [GitHub-30133](https://github.com/magento/magento2/issues/30133)

<!-- ENGCOM-8263 -->

* Cambiado `@param string $attribute` hasta `@param AbstractAttribute|string[]|string $attribute` in `EntityAbstract.php`. [GitHub-30191](https://github.com/magento/magento2/issues/30191)

<!-- ENGCOM-8142 -->

* Etiquetas no válidas (por ejemplo, `@package` y `@subpackage`) se han eliminado de los bloques de documentos en toda la base de código. [GitHub-30061](https://github.com/magento/magento2/issues/30061)

<!-- ENGCOM-8117 -->

* Parámetros no utilizados en la construcción del `AdvancedPricing` se han eliminado las clases. [GitHub-29531](https://github.com/magento/magento2/issues/29531)

### Productos configurables

<!-- MC-35016-->

* El filtrado de productos configurables sin existencias por precio ahora muestra los resultados dentro del rango de precios correcto.

<!-- MC-38930-->

* Un producto virtual ya no cambia de tipo cuando su estado se cambia de habilitado a deshabilitado (o viceversa). Anteriormente, la aplicación cambiaba el tipo de un producto de virtual a simple cuando cambiaba su estado.

<!-- MC-38197-->

* El `getValue()` ya no almacena en déclencheur un error grave al actualizar los carros de compras.

<!-- MC-34444-->

* Los productos configurables que están disponibles en varios sitios web ya no muestran productos secundarios simples que no están asignados al sitio web específico. [GitHub-28291](https://github.com/magento/magento2/issues/28291)

<!-- ENGCOM-8202 -->

* Las páginas de productos de Storefront ahora muestran precios de nivel sin impuestos como se esperaba. [GitHub-12225](https://github.com/magento/magento2/issues/12225)

<!-- ENGCOM-8134 8174-->

* Los precios del MSRP para los productos configurables ahora se convierten correctamente a la moneda elegida. Anteriormente, la aplicación mostraba los precios en la moneda incorrecta y arrojaba este error:  `Call to a member function setAppliedTaxes() on null`. [GitHub-26526](https://github.com/magento/magento2/issues/26526), [GitHub-29603](https://github.com/magento/magento2/issues/29603)

<!-- ENGCOM-8234 -->

* Los comerciantes ahora pueden guardar una etiqueta de opción de atributo de muestra de texto específica de un almacén con un valor de 0 (cero). Anteriormente, un valor de 0 se reemplazaba por el valor de la opción Etiqueta de administrador. [GitHub-30073](https://github.com/magento/magento2/issues/30073)

### cron

<!-- MC-37712-->

* La lista de mensajes del sistema ahora refleja con precisión las actualizaciones de productos después de `cron` se ha ejecutado y la aplicación ha actualizado los productos según lo programado.

<!-- ENGCOM-8164 -->

* Un índice basado en `schedule_id` y `status` se ha añadido a `cron_schedule` tabla. [GitHub-29601](https://github.com/magento/magento2/issues/29601)

### Atributos del cliente personalizados

<!-- MC-23545-->

* La aplicación ahora muestra atributos del cliente del tipo `file` en la página Información de la cuenta después de la creación. Anteriormente, al intentar guardar un nuevo atributo de este tipo, la aplicación mostraba estos errores: `The "newAttribute" attribute value is empty. Set the attribute and try again` y `Validation is failed`.

<!-- MC-23544-->

* La aplicación ahora muestra correctamente los valores de atributos del cliente personalizados de varias líneas. Anteriormente, no se mostraban todos los datos.

<!-- MC-36978-->

* La aplicación ahora avisa a los compradores cuando introducen una fecha de nacimiento no válida al crear una cuenta. Anteriormente, el validador no tenía en cuenta la configuración regional y se redirigía a los compradores a la página Crear nueva cuenta de cliente con un error de fecha no válido.

<!-- MC-38846-->

* Los atributos de dirección personalizados ahora se incluyen según lo esperado en la Etapa de pago del flujo de trabajo de cierre de compra.

<!-- MC-38114-->

* Los atributos de selección múltiple de direcciones personalizadas ahora se muestran correctamente durante el cierre de compra de invitados y en la página de detalles de pedidos de Administración y Mi cuenta.

<!-- MC-37101-->

* Ahora puede eliminar un cero a la izquierda en un atributo de cliente personalizado cuando `Input Type` se establece en `Text` y `Input Validation` se establece en `Numeric Only`.

<!-- MC-36721-->

* La aplicación ahora exporta correctamente datos de clientes que incluyen un valor de atributo de género personalizado.

### Cliente

<!-- MC-35771-->

* El widget de calendario para el campo Fecha de nacimiento de la página de cuenta del cliente de tienda ahora utiliza la configuración regional de tienda designada.

<!-- MC-38498-->

* La aplicación ya no guarda entradas duplicadas de una dirección de cliente durante la retirada de un pedido nuevo para un cliente existente del administrador.

<!-- MC-37393-->

* Al eliminar todas las direcciones de varios clientes desde el Administrador, ahora se eliminan todas las direcciones de la lista de direcciones de clientes y se eliminan las direcciones de facturación y envío predeterminadas. Anteriormente, la aplicación eliminaba la dirección de la lista de direcciones de clientes, pero no eliminaba las direcciones de facturación y envío predeterminadas.

<!-- MC-37377-->

* La pestaña Admin customer address ahora muestra correctamente el recuento de direcciones después de que un administrador haya realizado una eliminación masiva de direcciones. Anteriormente, la aplicación incluía direcciones eliminadas en el recuento.

<!-- MC-36718-->

* El formato DateTime para **Fecha de nacimiento** se ha corregido el campo de la página de registro del cliente. Anteriormente, faltaba el cero a la izquierda que precedía a un día de un solo dígito.

<!-- MC-36024-->

* Validación de formato de fecha para **Fecha de nacimiento** ahora funciona antes de que el comprador haga clic en **Crear una cuenta** botón. Anteriormente, un comprador podía introducir un valor en un formato no válido y al hacer clic en el botón **Crear una cuenta** , se redirigió al comprador a la página Crear nueva cuenta de cliente con un error de fecha no válido.

<!-- MC-33867-->

* La aplicación ya no genera un error grave cuando un administrador intenta guardar una nueva cuenta de cliente que contiene datos no válidos para un atributo.

<!-- MC-36258-->

* La aplicación ya no emite un error 400 cuando un cliente intenta acceder a su carro de compras en una implementación en la que Magento Shipping estaba instalado anteriormente y la temática de Luma predeterminada está implementada actualmente. Anteriormente, la aplicación no filtraba los nombres de sección creados por módulos instalados o habilitados anteriormente que no eran compatibles con el administrador antes de enviar solicitudes al servidor, lo que generaba errores.

<!-- MC-35812-->

* La aplicación ahora muestra un mensaje como se espera cuando un comprador crea una cuenta de invitado cuando el **Requerir confirmación de correos electrónicos** La configuración está habilitada y `Magento\Customer\Controller\Account\CreatePost` se ha anulado. Anteriormente, la aplicación no permitía este tipo de personalización del proceso de registro de usuarios y, bajo estas condiciones, el estado de confirmación de correo electrónico de un usuario se consideraba completo, el nuevo usuario iniciaba sesión automáticamente y no se mostraba ningún mensaje de error.

<!-- ENGCOM-8039 -->

* La aplicación ahora asigna un comprador al grupo de clientes correcto cuando el comprador realiza un pedido con un grupo de clientes no predeterminado en una tienda donde **Habilitar la asignación automática al grupo de clientes** está activada. [GitHub-26976](https://github.com/magento/magento2/issues/26976)

<!-- MC-39783-->

* La cuadrícula Clientes administradores ahora está disponible como se espera cuando el sitio web no predeterminado se elimina en una implementación de varios sitios cuando los índices se establecen en **Actualizar según lo programado**. Anteriormente, la aplicación no mostraba la cuadrícula y arrojaba este error:  `[2020-12-09 11:31:54] report.CRITICAL: The website with id 2 that was requested wasn't found. Verify the website and try again. \{"exception":"[object] (Magento\\Framework\\Exception\\NoSuchEntityException(code: 0): The website with id 2 that was requested wasn't found. Verify the website and try again. at /var/www/html/magento24ee/vendor/magento/module-store/Model/WebsiteRepository.php:110)"}`

### dotdigital

* La gestión de errores se ha mejorado al recuperar listas de programas desde dotdigital Engagement Cloud.

* El valor que se sincroniza en la columna de nombre de tienda durante la sincronización de invitados es ahora el nombre de la vista de tienda según lo esperado. Anteriormente, el nombre del sitio web se incluía en esta columna.

* Se ha añadido una comprobación de matriz antes de realizar un bucle en las automatizaciones del estado de los pedidos después de guardar un pedido.

* Se han resuelto problemas con las actualizaciones de Composer que eran el resultado de la dependencia del módulo dotdigital en `magento/module-authorization`.

### Descargable

<!-- ENGCOM-7679 -->

* La aplicación ya no incluye un producto descargable en la pestaña Mis productos de descarga después de que el pedido al que pertenece se haya reembolsado parcialmente. [GitHub-28388](https://github.com/magento/magento2/issues/28388)

### EAV

<!-- MC-35934-->

* Atributos personalizados que utilizan `\Magento\Eav\Model\Entity\Attribute\Backend\ArrayBackend` ahora utilice valores predeterminados si no se proporciona ningún valor en la carga útil cuando se crea un producto mediante una llamada de API.

### Correo electrónico

<!-- ENGCOM-7961 -->

* `\Magento\Config\Model\Config\Source\Email\Template::toOptionArray` ya no genera un error cuando `setPath()` no se llama antes de `toOptionArray()`. [GitHub-29315](https://github.com/magento/magento2/issues/29315)

<!-- MC-36777-->

* La aplicación ahora convierte correctamente el texto sin formato en HTML al hacer clic en **Devolver Versión Html** al cargar una plantilla de correo electrónico.

<!-- MC-34803-->

* El correo electrónico enviado a los clientes que contienen facturas parciales ahora incluye subtotales de artículos precisos. Anteriormente, el subtotal de este correo electrónico era el total de la cantidad pedida, no la cantidad total de la cantidad facturada.

<!-- MC-38337-->

* La aplicación ahora envía recordatorios por correo electrónico a todos los clientes relevantes con direcciones de correo electrónico válidas. Anteriormente, la aplicación dejaba de enviar correos electrónicos de recordatorio a los clientes después de encontrar una dirección no válida.

<!-- ENGCOM-7517 -->

* El envío del correo electrónico de ventas en modo asincrónico ahora funciona como se espera después de que se elimine un producto de un catálogo. Anteriormente, el envío asincrónico de correo electrónico se bloqueaba y la aplicación mostraba este error:  `main.ERROR: Cron Job sales_send_order_invoice_emails has an error: Call to a member function getData() on null. Statistics: {"sum":0,"count":1,"realmem":0,"emalloc":0,"realmem_start":73400320,"emalloc_start":37177640} [] []main.CRITICAL: Error when running a cron job {"exception":"[object] (RuntimeException(code: 0): Error when running a cron job at /var/www/html/vendor/magento/module-cron/Observer/ProcessCronQueueObserver.php:327, Error(code: 0): Call to a member function getData() on null at /var/www/html/vendor/magento/module-catalog/Helper/Image.php:502)"} []`. [GitHub-26878](https://github.com/magento/magento2/issues/26878)

<!-- ENGCOM-8381 -->

* La aplicación ya no copia un cliente en el correo electrónico de confirmación del pedido cuando `sales_email/order_comment/enabled` está desactivado y `sales_email/order_comment/copy_method` se establece en `bcc`. [GitHub-29915](https://github.com/magento/magento2/issues/29915)

### Marcos

<!-- MC-24195-->

* Los grupos de filtros personalizados ahora se aplican correctamente al buscar clientes. Anteriormente, la variable `afterSearch` La función no tenía los filtros OR esperados. [GitHub-24576](https://github.com/magento/magento2/issues/24576)

<!-- MC-36942-->

* Las imágenes de la página principal de una tienda ahora se representan correctamente. Anteriormente, el HTML de origen de página estaba dañado porque las tres barras consecutivas del código base64 de la imagen se interpretaban erróneamente como un comentario.

<!-- MC-37369-->

* DatePicker ahora funciona correctamente cuando se filtran pedidos en la lista Pedidos de administración en tiendas que utilizan la configuración regional árabe (`ar_SA - Saudi Arabia`).

<!-- MC-38344-->

* DatePicker ahora muestra la fecha correcta después de que un comerciante guarde una regla de precio de carro de compras en una implementación. [GitHub-30382](https://github.com/magento/magento2/issues/30382)

<!-- MC-31085-->

* La aplicación ahora representa correctamente la agrupación de miles árabes y los símbolos separadores decimales árabes. Anteriormente, los símbolos árabes estaban recortados. [GitHub-26676](https://github.com/magento/magento2/issues/26676)

<!-- MC-30631-->

* La aplicación ahora elimina las sesiones de base de datos caducadas de la base de datos `session` como se esperaba.

### Correcciones generales

<!-- MC-38105-->

* Ahora puede configurar un controlador de sesión nativo que difiera del controlador definido en `php.ini`. Anteriormente, `SessionManager` no se estableció memcache como `save_handler`, pero en su lugar utilizó el del archivo `session_handler`. la aplicación ha devuelto este error: `main.CRITICAL: Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 {"exception":"[object] (Exception(code: 0): Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in ../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 at ../vendor/magento/framework/App/ErrorHandler.php:61)"}`. [GitHub-24717](https://github.com/magento/magento2/issues/24717)

<!-- ENGCOM-8052 -->

* Se han realizado las siguientes mejoras en el `LoginAsCustomer` módulos:

   * Se reemplazaron los `around` plug-in con `after`

   * Código redundante eliminado

   * Reemplazado `(bool)->getValue()` con `isSetFlag`. [GitHub-29689](https://github.com/magento/magento2/issues/29689)

<!-- ENGCOM-8093 -->

* La recarga de todas las secciones de datos del cliente mediante el comodín (*) ya no hace que las solicitudes se procesen `customer/section/load` para generar un error 400. [GitHub-28154](https://github.com/magento/magento2/issues/28154)

<!-- ENGCOM-7994 -->

* La aplicación ahora pasa las excepciones que se producen cuando se procesa un diseño en el modo de producción a `var/report`. [GitHub-29606](https://github.com/magento/magento2/issues/29606)

<!-- MC-35058-->

* Los comerciantes ahora pueden desasignar productos de las categorías según lo esperado. Anteriormente, la aplicación arrojaba un error similar a este error: `Could not save product "4" with position 0 to category 3`.

<!-- ENGCOM-7527 -->

* La aplicación ahora emite una excepción cuando un cliente que no existe solicita un restablecimiento de contraseña. [GitHub-26288](https://github.com/magento/magento2/issues/26288)

<!-- MC-33687 ENGCOM-8497-->

* La aplicación ahora muestra un mensaje de error informativo cuando un administrador intenta guardar una cuenta de cliente que contiene un valor no válido para un atributo de cliente mientras carga un archivo que contiene este valor de atributo. Anteriormente, la aplicación arrojaba un error grave. [GitHub-30295](https://github.com/magento/magento2/issues/30295)

<!-- ENGCOM-8400 -->

* La aplicación ahora aplica el **Logotipo para vista de impresión de HTML** ajuste de configuración para almacenar los PDF de facturas según lo esperado. [GitHub-24730](https://github.com/magento/magento2/issues/24730)

<!-- ENGCOM-8425 -->

* `static::` se ha reemplazado por `self::` en todo el código base para acceder a constantes privadas. [GitHub-30781](https://github.com/magento/magento2/issues/30781)

<!-- ENGCOM-8395 -->

* La aplicación ahora abre la página Nuevo atributo como se espera cuando un comerciante hace clic en **Crear nuevo atributo** dos veces durante la creación del producto. Anteriormente, la aplicación mostraba una página vacía y arrojaba un error. [GitHub-30361](https://github.com/magento/magento2/issues/30361)

<!-- ENGCOM-8426 -->

* La aplicación ya no muestra el `The coupon code has been accepted` después de eliminar un cupón. [GitHub-30255](https://github.com/magento/magento2/issues/30255)

<!-- ENGCOM-8396 -->

* Los administradores ahora pueden asignar widgets a categorías específicas. [GitHub-30009](https://github.com/magento/magento2/issues/30009)

<!-- ENGCOM-8216 -->

* Selector de atributos `input[type=datetime]` se ha reemplazado por un selector de tipo de entrada menos específico. [GitHub-30064](https://github.com/magento/magento2/issues/30064)

<!-- ENGCOM-8282 -->

* La aplicación ahora muestra valores específicos de tienda asociados con atributos de categoría personalizados según lo esperado. [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-8287 -->

* La aplicación ahora muestra un mensaje preguntando si el grupo de clientes debe cambiarse al hacer clic en **Validar número de IVA** botón en la página de creación del pedido cuando la dirección de la tienda y el destino de envío pertenecen a diferentes países de la UE. [GitHub-29652](https://github.com/magento/magento2/issues/29652)

<!-- ENGCOM-8031 -->

* El `\Magento\Catalog\Model\ImageUploader` La clase se ha refactorizado para utilizar el nuevo `moveFileFromTmp` método. [GitHub-29598](https://github.com/magento/magento2/issues/29598)

<!-- ENGCOM-8178 -->

* La aplicación ahora muestra un mensaje de error más informativo cuando un comerciante intenta crear un atributo de producto con `product_type` y `type_id` códigos para que sean más descriptivos. [GitHub-28479](https://github.com/magento/magento2/issues/28479)

<!-- ENGCOM-8135 -->

* Se ha corregido la lógica de validación para **Duración del token del cliente (horas)**  y **Duración del token de administrador (horas)** campos en el Administrador **Tiendas**  >  **Configuraciones** >  **Servicios**  > **OAuth** página. [GitHub-29502](https://github.com/magento/magento2/issues/29502)

<!-- ENGCOM-8132 -->

* La aplicación ahora analiza correctamente el texto que contiene `}}` en el campo widget content. [GitHub-12087](https://github.com/magento/magento2/issues/12087)

<!-- ENGCOM-8098 -->

* Ahora puede quitar un filtro de la página Categorías de productos. Anteriormente, cuando se intentaba eliminar el filtro, la aplicación no permitía eliminarlo y mostraba este error:  `Something went wrong`. [GitHub-8538](https://github.com/magento/magento2/issues/8538)

<!-- ENGCOM-8050 -->

* `Magento\Framework\MessageQueue\ConfigInterface` ahora se puede crear una instancia cuando el módulo opcional `Magento_MessageQueue` está deshabilitada. Anteriormente, la aplicación arrojaba este error: `PHP Fatal error:  Uncaught Error: Cannot instantiate interface Magento\Framework\MessageQueue\ConfigInterface in /var/www/magento2/magento2/lib/internal/Magento/Framework/ObjectManager/Factory/AbstractFactory.php:121`. [GitHub-26080](https://github.com/magento/magento2/issues/26080)

<!-- ENGCOM-7312 -->

* Se ha mejorado la lógica que determina cuándo la aplicación puede recuperar el valor del correo electrónico del almacenamiento persistente. Anteriormente, la aplicación mostraba campos de contraseña rellenados en la página de cierre de compra cuando un usuario no registrado regresaba a la página de cierre de compra después de completar por primera vez el campo de correo electrónico. [GitHub-26903](https://github.com/magento/magento2/issues/26903)

<!-- ENGCOM-7777 -->

* Falta una `aclResource` se ha añadido el atributo al encabezado Admin `AdminNotification` bloque de barra de herramientas. Anteriormente, la entrada de la barra de herramientas de notificación de administración era visible incluso cuando el usuario administrador no tenía permisos de recursos de funciones para verla. [GitHub-29067](https://github.com/magento/magento2/issues/29067)

<!-- ENGCOM-8022 -->

* El `framework/database/select` `where` ahora, las funciones gestionan `type` correctamente. [GitHub-29590](https://github.com/magento/magento2/issues/29590)

<!-- ENGCOM-8260 -->

* Uso ineficiente de `array_merge` en los bucles se ha mejorado en todo el código base, lo que ha mejorado el rendimiento en varios lugares, incluido el proceso de implementación de contenido estático. [GitHub-30183](https://github.com/magento/magento2/issues/30183)

<!-- ENGCOM-8445 -->

* La duración predeterminada de la sesión de administración se ha trasladado del módulo de cifrado al módulo de seguridad. [GitHub-30859](https://github.com/magento/magento2/issues/30859)

<!-- ENGCOM-8425 -->

* La aplicación ahora comprueba las constantes privadas de una clase y muestra una advertencia si hay alguna `static::` llamadas a ellos. Anteriormente, la aplicación arrojaba este error: `Undefined class constant`.

<!-- ENGCOM-8326 -->

* Se ha agregado compatibilidad con symlinked `root` en las páginas de errores y en el modo de mantenimiento. Anteriormente, si la variable `root` o `magento/pub` se han vinculado simbólicamente a un directorio diferente, el procesador de errores (`Magento\Framework\Error\Processor`) no ha generado una URL de archivo de vista correcta. [GitHub-30296](https://github.com/magento/magento2/issues/30296)

<!-- ENGCOM-8087 -->

* Añadido faltante `order_data` matriz a `EmailSender` clases. Esto alinea estas clases con la recomendación de Magento de utilizar variables escalares en lugar de objetos dentro de las plantillas de correo electrónico. [GitHub-29604](https://github.com/magento/magento2/issues/29604)

### GraphQL

<!-- MC-37615-->

* El solucionador de URL de GraphQL ahora gestiona correctamente los parámetros de consulta. Anteriormente, devolvía NULL al administrar direcciones URL compatibles con SEO con parámetros.

<!-- ENGCOM-8422 -->

* El solucionador de URL de GraphQL ahora gestiona correctamente la jerarquía de páginas de CMS. Anteriormente, devolvía NULL. [GitHub-30474](https://github.com/magento/magento2/issues/30474)

<!-- MC-38209-->

* Consultas de la lista de productos `categories.breadcrumbs` los datos ya no devuelven datos de ruta de exploración para categorías cuya categoría principal esté deshabilitada. [GitHub-30468](https://github.com/magento/magento2/issues/30468)

<!-- MC-38407-->

* La ruta a una imagen de categoría ahora se devuelve correctamente cuando las reescrituras de URL están desactivadas.

<!-- MC-36648-->

* La aplicación ahora devuelve un mensaje más informativo cuando se produce un error con durante una operación de restablecimiento de contraseña de GraphQL. [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-38078-->

* Las posiciones de los productos ahora se actualizan según lo esperado en los resultados de la consulta de GraphQL cuando los resultados de la consulta se almacenan en caché.

<!-- MC-35355-->

* El `products` ahora devuelve los resultados esperados cuando el `category_id`  El filtro se especifica con `in` palabra clave. [GitHub-30349](https://github.com/magento/magento2/issues/30349)

<!-- ENGCOM-8219 -->

* Reglas añadidas a `editorconfig` para admitir la sangría de archivos JSON y YAML en dos espacios. [GitHub-30066](https://github.com/magento/magento2/issues/30066), [GitHub-30063](https://github.com/magento/magento2/issues/30063)

<!-- ENGCOM-8079 -->

* El `FlushCacheByTags` se ha actualizado para utilizar complementos posteriores en lugar de complementos. [GitHub-29558](https://github.com/magento/magento2/issues/29558)

<!-- ENGCOM-8370 -->

* Código en la `checkout_index_index.xml` se ha mejorado con la eliminación de `sortOrder` de `messages`, `authentication`, `progressBar`, `estimation`, y `sidebar checkout` componentes. [GitHub-30550](https://github.com/magento/magento2/issues/30550)

<!-- ENGCOM-8379 -->

* Contenido en `calc` ahora se escapa, lo que da como resultado lo correcto `calc` en el archivo de salida CSS. Anteriormente, la aplicación devolvía un `calc` valor. [GitHub-30542](https://github.com/magento/magento2/issues/30542)

<!-- ENGCOM-8030 -->

* El generador de reescritura de URL ahora establece el objeto category `url_key`, `url_path`, y  `store_id` para almacenar los valores predeterminados al guardar las reescrituras de URL de categoría para el ámbito global. Anteriormente, se guardaba `url_key`, `url_path`, y `store_id` con los valores del último ID de almacén procesado. [GitHub-29585](https://github.com/magento/magento2/issues/29585)### Productos agrupados

<!-- MC-35361-->

* La consulta de productos ahora devuelve todos los datos esperados para los productos agrupados. Anteriormente, `product_links` era una matriz vacía.

<!-- MC-37718-->

* Un producto agrupado aparece ahora como agotado en la página de edición del producto cuando todos los productos secundarios simples están agotados.

<!-- MC-37249-->

* El estado de un producto agrupado ahora se actualiza correctamente en la página de edición del producto cuando el estado de sus productos secundarios simples cambia a sin existencias. Anteriormente, el artículo de stock de inventario para el principal del producto agrupado no se actualizaba después de que sus secundarios cambiaran el estado de stock.

<!-- ENGCOM-8250 -->

* `\Magento\Widget\Controller\Adminhtml\Widget\Instance\Validate` ahora reconoce un valor de resultado de frase como un mensaje de error y lo envía al usuario durante la validación del widget. [GitHub-27397](https://github.com/magento/magento2/issues/27397)

<!-- ENGCOM-8311 -->

* La lista codificada de atributos de categoría en  `Magento\Catalog\Model\Category\DataProvider::getFieldsMap()` se ha reemplazado por una lista de atributos generados a partir de la caché. [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-7759 -->

* Hash redundante de `req.http.host/client.ip` se ha eliminado y el hash se gestiona mediante la VCL integrada de Varnish. [GitHub-29988](https://github.com/magento/magento2/issues/29988)

<!-- ENGCOM-8302 -->

* Se ha agregado una llamada de retorno de error a `Magento_Ui` cargador de archivos. [GitHub-29557](https://github.com/magento/magento2/issues/29557)

<!-- ENGCOM-8405 -->

* Un `acl.xml` incoherencia que se producía al `Magento_LoginAsCustomerAssistance` estaba habilitado, pero `Magento_LoginAsCustomerAdminUi` o `Magento_LoginAsCustomerLog` se ha corregido la selección de deshabilitadas. Anteriormente, cuando un administrador con estas credenciales intentaba iniciar sesión en Admin, la aplicación mostraba una página en blanco y arrojaba este error cuando:  `Exception #0 (LogicException): Could not create an acl object: Invalid Document Element 'resource': The attribute 'title' is required but missing. Line: 13`. [GitHub-30680](https://github.com/magento/magento2/issues/30680)

<!-- ENGCOM-8157 -->

* La aplicación ya no emite un `Undefined class constant` error al crear un `Interceptor` se genera durante la creación del complemento. [GitHub-28981](https://github.com/magento/magento2/issues/28981), [GitHub-29879](https://github.com/magento/magento2/issues/29879)

<!-- ENGCOM-8108 -->

* La aplicación ahora gestiona correctamente la mensajería y el registro para operaciones asíncronas masivas. Anteriormente, aunque los productos se actualizaban, la variable `magento_operation` y `queue_message_status` no se actualizaban correctamente y los mensajes del sistema eran incorrectos. [GitHub-29718](https://github.com/magento/magento2/issues/29718)

<!-- ENGCOM-8388 -->

* Ahora se redirige a un comprador a la página Definir una nueva contraseña tal como se espera cuando hace clic en **Establecer una nueva contraseña** en el correo electrónico Restablecer contraseña cuando **Requerir confirmación de correos electrónicos** está habilitado para la tienda. Anteriormente, el comprador se redirigía de nuevo a **Olvidé su contraseña** en la página de inicio de sesión. [GitHub-27954](https://github.com/magento/magento2/issues/27954)

<!-- ENGCOM-8337 -->

* Se corrigió el error de conversión de matriz a cadena al guardar la configuración del sistema de filas con valores predeterminados. [GitHub-30314](https://github.com/magento/magento2/issues/30314)

<!-- ENGCOM-8440 -->

* Ahora puede establecer argumentos para colas de mensajes. [GitHub-30216](https://github.com/magento/magento2/issues/30216)

<!-- ENGCOM-8384 -->

* El recolector de archivos base ahora respeta `AppState->emulateAreaCode()`. [GitHub-39656](https://github.com/magento/magento2/issues/29656)

<!-- ENGCOM-8441 -->

* El nuevo `BlockByIdentifier` La clase admite la recuperación de un bloque de diseño basado en el identificador de bloque CMS. Como resultado, cuando se elimina un bloque CMS de la caché, la aplicación también borra la caché de bloques de diseño. [GitHub-28309](https://github.com/magento/magento2/issues/28309)

<!-- ENGCOM-8385 -->

* Se corrigieron problemas con la conversión de argumentos numéricos en colas. Anteriormente, al declarar una cola con valores numéricos `type` argumentos en la variable `queue_topology.xml`, el valor del argumento se convirtió en cadena. [GitHub-29615](https://github.com/magento/magento2/issues/29615)

### GraphQL

<!-- MC-37615-->

* El `urlResolver` query ahora gestiona correctamente los parámetros de consulta.

<!-- ENGCOM-8422 -->

* El `urlResolver` La consulta ya no devuelve NULL cuando se especifican un nodo y una página CMS personalizados como entrada. [GitHub-30474](https://github.com/magento/magento2/issues/30474)

<!-- MC-38209 ENGCOM-8386-->

* El `category` La consulta ya no devuelve las categorías secundarias de una categoría principal que se haya deshabilitado. [GitHub-30468](https://github.com/magento/magento2/issues/30468)

<!-- MC-38407-->

* El `category` La consulta ahora devuelve la ruta correcta de una imagen de categoría cuando las reescrituras de URL están desactivadas.

<!-- MC-36648 8321-->

* El `resetPassword` mutation ahora devuelve un mensaje más informativo cuando se produce un error. [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-38078 ENGCOM-8504-->

* Resultados en caché de la `products` Las consultas de se invalidan según lo esperado cuando cambian las posiciones de los productos. [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- MC-35355 ENGCOM-8404-->

* El `products` ahora devuelve los resultados esperados cuando el `category_id` El filtro se especifica con `in` palabra clave. [GitHub-30349](https://github.com/magento/magento2/issues/30349)

<!-- ENGCOM-8373 -->

* El `categories` y `categoryList` Las consultas de ahora consideran la disponibilidad de las categorías en función de la configuración de permisos de categorías y el ID de categoría principal. [GitHub-29880](https://github.com/magento/magento2/issues/29880), [GitHub-30624](https://github.com/magento/magento2/issues/30624)

<!-- MC-37603-->

* El `updateProductsInWishList` mutation ahora valida correctamente los elementos de la lista de deseos. [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- ENGCOM-8430 PWA-1107-->

* Varios atributos obsoletos en la `ProductInterface` y `CategoryInterface` para evitar su uso en la tienda. [GitHub-30625](https://github.com/magento/magento2/issues/30625)

* Los precios ahora están ocultos en los resultados de las consultas de productos cuando los permisos de categoría están configurados para ocultarlos. [GitHub-29926](https://github.com/magento/magento2/issues/29926)

<!-- MC-36898 PWA-1299-->

* Ahora puede utilizar la variable `addProductsToWishList` mutación para añadir un producto agrupado con una cantidad definida por el usuario a una lista de deseos.

<!-- MC-36946 -->

* Ha mejorado el tiempo de respuesta de GraphQL para operaciones de añadir al carro de compras.

<!-- ENGCOM-8099 -->

* El `products` La consulta ahora devuelve valores de precio de nivel según lo esperado. [GitHub-29168](https://github.com/magento/magento2/issues/29168)

<!-- ENGCOM-7528 -->

* Se ha eliminado un redundante `getMappedNums` desde un bucle en `lib/internal/Magento/Framework/GraphQl/Query/EnumLookup.php`. [GitHub-30031](https://github.com/magento/magento2/issues/30031)

<!-- ENGCOM-8172 -->

* El `products` query ya no devuelve un error cuando el producto consultado tiene un producto relacionado deshabilitado. [GitHub-28892](https://github.com/magento/magento2/issues/28892)

<!-- MC-37395 -->

* El `cart` La consulta ahora devuelve los precios que se han convertido a la moneda correcta (la moneda de visualización predeterminada). Anteriormente, la consulta devolvía el valor del precio del artículo en la moneda base y el código de moneda se devolvía como moneda de presentación predeterminada.

<!-- MC-37388-->

* GraphQL ahora respeta los permisos del catálogo. La aplicación restringe los elementos que se devuelven para un `products` consulta basada en el grupo de clientes del comprador.

<!-- MC-39690-->

* Se ha añadido la `customizable_option` a varios tipos de datos que implementan el `CartItemInterface`.

<!-- MC-39744-->

* Se han añadido atributos para `storeConfig` consulta para devolver información de tienda, grupo de tienda y sitio web.

<!-- MC-37414-->

* Se restableció el `SelectedCustomizableOption.type` atributo. Además, la variable `customizable_options` dentro de varias implementaciones de `CartItemInterface` ahora no son nulas.

<!-- MC-23860-->

* La funcionalidad de búsqueda de `products` La consulta ya no devuelve elementos en los que se han habilitado permisos de categoría.

<!-- MC-37726-->

* El `products` La consulta devuelve la moneda correcta para las vistas de tienda que tienen varias monedas.

<!-- MC-37727-->

* Etiquetas para `products` los filtros de consulta ahora devuelven valores traducidos, cuando corresponde, para las vistas de tienda no predeterminadas.

<!-- MC-37728-->

* Se han corregido importes en moneda de tienda en tarjetas de regalo del carro de compras.

<!-- MC-38443-->

* Se ha añadido la `ConfigurableProductOptionsSelection` tipo de datos, que contiene metadatos correspondientes a las opciones configurables y seleccionables de un producto. Utilice este objeto en un `products` consulta para minimizar el número de elementos de la galería de medios que se muestran cuando el comprador selecciona opciones de producto configurables.

### Imágenes

<!-- MC-36942-->

* Las imágenes de la página principal de una tienda ahora se representan correctamente. Anteriormente, el HTML de origen de página estaba dañado porque las tres barras consecutivas del código base64 de la imagen se interpretaban erróneamente como un comentario.

<!-- ENGCOM-8116 -->

* La dependencia del `fileinfo` La extensión de se ha eliminado del módulo CMS. Anteriormente, la aplicación generaba un error al intentar cargar una imagen con el cargador de imágenes, que se iniciaba al hacer clic en **Insertar imagen** al añadir contenido. [GitHub-24332](https://github.com/magento/magento2/issues/24332), [GitHub-16531](https://github.com/magento/magento2/issues/16531), [GitHub-29852](https://github.com/magento/magento2/issues/29852)

<!-- ENGCOM-8020 -->

* Se ha agregado compatibilidad para leer `exif_image.png` o `exif-image.jpeg` metadatos. [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- ENGCOM-8296 -->

* Los colores de las imágenes CMYK ahora se representan correctamente. Cuando el adaptador de Imagick detecta ahora que una imagen abierta tiene un espacio de color CMYK, el espacio de color se convierte en SRGB. Anteriormente, estas imágenes se representaban con colores invertidos. [GitHub-22375](https://github.com/magento/magento2/issues/22375)

<!-- ENGCOM-8251 -->

* Los valores booleanos ya no están configurados para `image_with_border.phtml`. Redundante `max-width` y `height` La configuración de se ha eliminado de `.product-image-photo`. (Estos valores ya se han establecido globalmente en la imagen mediante los estilos de restablecimiento). [GitHub-30186](https://github.com/magento/magento2/issues/30186)

### Importar/exportar

<!-- MC-35081-->

* Dirección del cliente `region_id` ya no tiene asignado un `NULL` cuando se importan direcciones de clientes mediante un archivo CSV (`entity type = "customer address"` y `import behavior = "add/update"`) de los cuales se han eliminado ciertos valores de campo.

<!-- MC-35295-->

* Ahora puede ocultar imágenes de productos en la tienda durante la importación.

<!-- MC-35836-->

* Cuando un producto importado tenga `qty` establecido en 0 pero `is_in_stock set` al 1 en el archivo CSV, el producto no aparece en la página de categoría y la página de detalles del producto lo identifica como agotado. Anteriormente, los productos con estos valores eran visibles en la tienda después de la importación.

<!-- MC-38433-->

* La importación de CSV ya no ignora el `dropdown` y `textarea` valores para atributos adicionales. Anteriormente, estos valores de atributo no se actualizaban durante la importación.

<!-- MC-37933-->

* El archivo CSV de exportación de productos ahora aparece en la lista de administración de archivos CSV de exportación según lo esperado. Anteriormente, la aplicación arrojaba un error cuando ejecutaba este comando: `bin/magento queue:consumers:start exportProcessor --single-thread --max-messages=10000`.

<!-- MC-37672-->

* La aplicación ya no genera un error al importar datos CSV que incluyen caracteres del alfabeto bengalí (bengalí).

<!-- MC-36410-->

* La aplicación ahora muestra un mensaje de error informativo cuando un administrador hace clic en **Comprobar datos** durante la importación de un archivo que se ha cambiado desde la exportación cuando se trabaja en Chrome. Anteriormente, la aplicación mostraba un error de consola, pero no indicaba al usuario cómo proceder.

<!-- ENGCOM-8252 -->

* La aplicación ya no duplica imágenes de productos cuando se importan los mismos datos CSV del producto más de una vez. [GitHub-21885](https://github.com/magento/magento2/issues/21885)

<!-- ENGCOM-8262 -->

* El límite de 90 caracteres para los nombres de archivo de imagen en `vendor/magento/framework/File/Uploader.php` se ha eliminado.  Anteriormente, la longitud del directorio y el nombre de archivo no podía superar los 255 caracteres. La aplicación importó productos con imágenes cuyo nombre de archivo superaba este límite, pero no importó el archivo de imagen. [GitHub-29377](https://github.com/magento/magento2/issues/29377)

<!-- ENGCOM-8153 -->

* Los códigos de cupones ahora se pueden exportar correctamente a CSV o XML. Anteriormente, la aplicación mostraba un error 404 al hacer clic en **Exportar CSV** o **Exportar XML** cuando intentó exportar cupones. [GitHub-29277](https://github.com/magento/magento2/issues/29277)

<!-- ENGCOM-8252 -->

* Las imágenes de producto duplicadas ahora se eliminan después de importar un archivo CSV que contiene imágenes. [GitHub-14398](https://github.com/magento/magento2/issues/14398), [GitHub-21885](https://github.com/magento/magento2/issues/21885)

### Índice

<!-- MC-38003-->

* Hemos mejorado el rendimiento del indexador parcial. La aplicación ahora borra los ID de caché que se cambiaron para cada iteración de lote de 1000 ID. El contexto de caché ya no acumula ID. Anteriormente, el contexto de caché acumulaba ID de caché para cada iteración de lote de 1000 ID y borraba el mismo conjunto de ID en cada iteración.

<!-- ENGCOM-7929 -->

* Se han corregido las incoherencias entre el sistema de reindexación parcial y el sistema de reindexación completo. Ambos sistemas de indexación ahora utilizan el mismo código, que funciona correctamente. Anteriormente, ambos sistemas de indexación utilizaban una lógica diferente con respecto a los indexadores compartidos, lo que podía provocar que los indexadores se invalidaran después de cada ejecución del sistema de reindexación parcial. [GitHub-29478](https://github.com/magento/magento2/issues/29478), [GitHub-29297](https://github.com/magento/magento2/issues/29297)

<!-- MC-38168-->

* Hemos resuelto problemas con el indexador manual que habían resultado en páginas de categoría vacías o en una cantidad reducida de productos en las páginas de categoría. Se produjeron problemas con páginas de categoría o recuento de productos incompletos cuando:

   * el `catalogsearch_fulltext` y `catalog_product_price` los indexadores parciales se ejecutaron en un catálogo grande hasta que estos indexadores completaron la ejecución.

   * el indexador parcial se ejecutó en `catalog_category_product` o `catalog_product_category` y, al mismo tiempo, se ejecutó una reindexación completa en uno de esos índices. Estos dos procesos de indexación podrían entrar en conflicto, lo que provocaba que faltaran productos en las páginas de categoría.

   * `bin/magento indexer:reindex inventory` se ejecutó en un catálogo grande. Faltaban productos de las páginas de categoría hasta el `catalogsearch_fulltext` el indexador parcial completó la ejecución.

<!-- MC-39700-->

* Se ha agregado un indizador al `Magento_Bulk` Tabla MySQL, que ha mejorado el rendimiento de las operaciones por lotes.

<!-- MC-38806-->

* Los comentarios de las tablas de base de datos ahora reflejan con precisión el estado de la tabla después de volver a indexar (`bin/magento indexer:reindex`). Anteriormente, los comentarios de tabla después de la reindexación contenían los mismos valores que los comentarios contenidos después de una nueva instalación.

<!-- ENGCOM-7542 -->

* El `SELECT entity_id IN` La instrucción se ha mejorado en las implementaciones que implementan MariaDB v.10.3.18, lo que ha mejorado el rendimiento de la indexación de categorías de catálogo. [GitHub-25199](https://github.com/magento/magento2/issues/25199)

<!-- ENGCOM-8237 -->

* El Magento Open Source ha mejorado el rendimiento de la caché al eliminar el vaciado de etiquetas varias veces por instancia del indexador. [GitHub-29890](https://github.com/magento/magento2/issues/29890)

### Infraestructura

<!-- MC-34353-->

* Ahora puede utilizar `app/etc/env.php` para cambiar el agente de mensajes de MYSQL a AMQP.

<!-- MC-38242-->

* Los problemas con el cálculo de los residuos para los valores decimales de las cantidades de productos se han corregido en la biblioteca JavaScript correspondiente. La aplicación calculaba incorrectamente fracciones decimales de más de dos dígitos y, posteriormente, mostraba un mensaje incorrecto.

<!-- MC-38993 ENGCOM-8473-->

* El `\Magento\Authorization\Model\Rules::update` El método se ha desaprobado.  [GitHub-29128](https://github.com/magento/magento2/issues/29128)

<!-- ENGCOM-8000 -->

* La aplicación ya no emite un error grave al convertir un objeto de fecha de UTC. Anteriormente, bajo ciertas condiciones, la variable `convertConfigTimeToUtc` El método ha devuelto una excepción. [GitHub-29525](https://github.com/magento/magento2/issues/29525)

<!-- ENGCOM-7987 -->

* `DataObject` se ha reemplazado con el modelo de producto en `\Magento\MediaGalleryCatalogUi\Ui\Component\Listing\Columns\Thumbnail::prepareDataSource`.[GitHub-1711](https://github.com/magento/adobe-stock-integration/issues/1711)

<!-- ENGCOM-7914 -->

* El `RequireJS` el solucionador ya no detecta los recursos bloqueados. Anteriormente, la resolución no detectaba correctamente si todos los recursos de una página se cargaban o gestionaban correctamente, y la página se seguía cargando. [GitHub-28116](https://github.com/magento/magento2/issues/28116)

<!-- ENGCOM-8229 -->

* La validación de código del repositorio de atributos ahora respeta `Magento\Eav\Model\Entity\Attribute::ATTRIBUTE_CODE_MAX_LENGTH` en lugar de un valor codificado. [GitHub-29017](https://github.com/magento/magento2/issues/29017)

<!-- MC-35699-->

* La minificación de HTML ya no elimina las barras triples (//) de las cadenas del HTML en los archivos PHTML. Anteriormente, las barras triples se interpretaban como comentarios durante la minificación y el resto de la línea se eliminaba completamente en el archivo PHTML generado al implementarse.

<!-- MC-38201-->

* Los comerciantes ahora pueden configurar las suscripciones del indexador en el nivel de columna de tabla en lugar de en el nivel de tabla. Se ha añadido un nuevo argumento a `\Magento\Framework\Mview\View\Subscription` para permitir que las columnas se ignoren para una vista o combinación de tabla específica. [GitHub-30243](https://github.com/magento/magento2/issues/30243)

<!-- MC-30171-->

* Haciendo clic en **Añadir al carro** antes de que la página del producto JavaScript se inicialice completamente ya no genera duplicados `form_key` valores. Anteriormente, se podía agregar un producto al carro de compras con una caché `form_key` valor que activó una excepción. Cuándo **Añadir al carro** se ha hecho clic antes de que JavaScript se inicializara completamente y, a continuación, se ha `form_key` el valor enviado en los datos del formulario no coincide con la sesión de los usuarios y el producto no se agregó al carro de compras. [GitHub-13746](https://github.com/magento/magento2/issues/13746)

<!-- ENGCOM-8107 -->

* El cliente cURL actual ahora respeta los nombres de encabezado que no distinguen entre mayúsculas y minúsculas. Anteriormente, la variable `Set-Cookie` La comparación distingue entre mayúsculas y minúsculas, lo que podría causar problemas con algunos servidores HTTP. [GitHub-29524](https://github.com/magento/magento2/issues/29524)

<!-- ENGCOM-8360 -->

* Se ha actualizado el formato XSD URN en `api-functional` y archivos XML de casos de prueba. [GitHub-30552](https://github.com/magento/magento2/issues/30552)

<!-- ENGCOM-8295 -->

* Se han añadido un prefijo de evento y un objeto de evento a la colección de valores de opciones del producto del catálogo para mejorar la personalización de la carga de la colección de `\Magento\Catalog\Model\ResourceModel\Product\Option\Value\Collection`. [GitHub-29621](https://github.com/magento/magento2/issues/29621)

<!-- ENGCOM-8261 -->

* Todas las ocurrencias de `array_merge` se han refactorizado para utilizar el formato recomendado en el estándar de codificación. [GitHub-30005](https://github.com/magento/magento2/issues/30005)

<!-- ENGCOM-7718 -->

* A `head.additional` bloque de tipo `\Magento\Framework\View\Element\Text\ListText` se ha añadido a `adminhtml` `default` diseño (por `magento2/module-base`). [GitHub-29165](https://github.com/magento/magento2/issues/29165)

<!-- ENGCOM-8312 -->

* Se ha agregado el método de URL de escape que falta al widget de módulo de plantilla de diseño. [GitHub-30036](https://github.com/magento/magento2/issues/30036)

<!-- ENGCOM-8127 -->

* El `\Magento\Framework\Filesystem\Io\File::read()` ahora es compatible con `\Magento\Framework\Filesystem\Io\IoInterface::read()`. [GitHub-27866](https://github.com/magento/magento2/issues/27866)

### Klarna

* Se ha eliminado la dependencia del módulo PayPal. [GitHub-29421](https://github.com/magento/magento2/issues/29421)

### Registro

<!-- ENGCOM-8443 -->

* El `Magento_Logging` ahora registra correctamente nuevos valores, así como los valores que los precedieron. Anteriormente, los valores de la columna Valor antes del cambio mostraban valores N/D independientemente de si este era el primer cambio o el siguiente, o de cuándo se devolvía el valor predeterminado. [GitHub-26943](https://github.com/magento/magento2/issues/26943)

### Galería de medios

<!-- ENGCOM-8014 -->

* El administrador **Tiendas**  >  **Configuración**  >  **Avanzadas**  >  **Sistema** se ha actualizado la página para mostrar el nombre de producto correcto (Galería multimedia). Se han incluido pequeños rediseños en la interfaz de usuario. [GitHub-1738](https://github.com/magento/adobe-stock-integration/issues/1738)

<!-- ENGCOM-8019 -->

* Los vínculos de la sección Utilizado en de las descripciones de imágenes de la Galería multimedia ahora muestran una cuadrícula que la imagen seleccionada ha filtrado según lo esperado. Anteriormente, la cuadrícula mostrada no tenía un título correcto y las entradas de la lista no eran precisas. [GitHub-1694](https://github.com/magento/adobe-stock-integration/issues/1694)

<!-- ENGCOM-8019 -->

* Ahora puede editar correctamente varias imágenes en la Galería multimedia. Anteriormente, no se podían agregar etiquetas a una segunda imagen después de agregar etiquetas a una imagen. [GitHub-1755](https://github.com/magento/adobe-stock-integration/issues/1755)

<!-- ENGCOM-8015 -->

* El menú desplegable Etiquetas ahora está vacío tal como se espera después de quitar etiquetas de una imagen en la Galería multimedia.  [GitHub-1703](https://github.com/magento/adobe-stock-integration/issues/1703)

<!-- ENGCOM-8146 -->

* Ahora se admite el procesamiento por lotes de los mensajes de cola de sincronización de Media Gallery. [GitHub-1724](https://github.com/magento/adobe-stock-integration/issues/1724)

<!-- ENGCOM-8064 -->

* La aplicación ahora muestra una página 404 como se espera cuando intenta abrir la Galería multimedia cuando **Galería de medios mejorada** está deshabilitada. [GitHub-1760](https://github.com/magento/adobe-stock-integration/issues/1760)

<!-- ENGCOM-8072 -->

* `MediaGalleryMetadata` ahora omite el lector de segmentos si se produce una excepción y, en su lugar, analiza y muestra los metadatos de imagen según lo esperado. Anteriormente, los metadatos de la imagen estaban vacíos debido a una excepción del `exif_read_data` lector de segmentos. [GitHub-1782](https://github.com/magento/adobe-stock-integration/issues/1782)

<!-- ENGCOM-8069 -->

* La longitud del nombre de la carpeta ya no impide que se cargue una imagen en la Galería multimedia. La Galería multimedia ahora establece la columna de ruta como tipo `text`. [GitHub-1778](https://github.com/magento/adobe-stock-integration/issues/1778)

<!-- ENGCOM-8217 -->

* El cargador de imágenes ahora muestra el tamaño de imagen correcto cuando se inserta una representación desde la Galería multimedia. [GitHub-1806](https://github.com/magento/adobe-stock-integration/issues/1806)

<!-- ENGCOM-8467 -->

* La verificación de la ruta se ha agregado a `Mediagallery` complemento de cargador. Anteriormente, la validación fallaba y la aplicación no importaba productos cuando **Habilitar la galería de medios antigua** se ha deshabilitado. [GitHub-30649](https://github.com/magento/magento2/issues/30649)

<!-- ENGCOM-8057 -->

* `Magento_Cms::media_gallery` Se han agregado y aplicado subrecursos ACL para la nueva galería de medios para admitir permisos configurados para las siguientes operaciones discretas:

   * Cargar recursos
   * Insertar recursos en el contenido
   * Eliminar recursos
   * Creación de carpetas
   * Elimine carpetas. [GitHub-1487](https://github.com/magento/adobe-stock-integration/issues/1487)

<!-- ENGCOM-8047 -->

* Las cadenas de texto y los nombres de carpeta de la Galería multimedia larga ya no se recortan. Anteriormente, la aplicación mostraba texto recortado e imágenes y mostraba este mensaje:  `We couldn't find any records`. [GitHub-1763 ](https://github.com/magento/adobe-stock-integration/issues/1763), [GitHub-1758 ](https://github.com/magento/adobe-stock-integration/issues/1758)

<!-- ENGCOM-8042 -->

* La aplicación ya no muestra el **Agregar selección** cuando no se selecciona ninguna imagen mientras se edita el contenido de una página nueva. [GitHub-1769](https://github.com/magento/adobe-stock-integration/issues/1769)

<!-- ENGCOM-8047 -->

* Los filtros ahora se aplican según lo esperado en la **Contenido**  >  **Galería de medios** Cuadrícula de categorías. [GitHub-1763 ](https://github.com/magento/adobe-stock-integration/issues/1763)

<!-- ENGCOM-8183 -->

* La configuración de las opciones de multiplicación de puntos de interrupción de Gallery ahora funciona según lo esperado. Anteriormente, la configuración de las opciones de punto de interrupción no funcionaba correctamente porque `mediaCheck` se ha activado la función de consulta de medios de salida al cargar la página. [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### MFTF

<!-- ENGCOM-8359 -->

* Se han reemplazado las acciones repetitivas por grupos de acción en `CheckStaticBlocksTest`. [GitHub-30561](https://github.com/magento/magento2/issues/30561)

<!-- ENGCOM-8267 -->

* `AdminUpdateCategoryAndMakeInactiveTest` y `VerifyChildCategoriesShouldNotIncludeInMenuTest` han sido refactorizados para cumplir con las mejores prácticas de MFTF. [GitHub-30058](https://github.com/magento/magento2/issues/30058)

<!-- ENGCOM-8458 -->

* Eliminados duplicados `AdminOpenCMSBlocksGridActionGroup`. [GitHub-30896](https://github.com/magento/magento2/issues/30896)

<!-- ENGCOM-8156 -->

* Reemplazado `AdminOpentCmsBlockActionGroup` con AdminOpenCmsBlockActionGroup. [GitHub-29839](https://github.com/magento/magento2/issues/29839)

<!-- ENGCOM-8226 -->

* Obsoleto `GoToAttributeGridPageActionGroup`. [GitHub-30103](https://github.com/magento/magento2/issues/30103)

<!-- ENGCOM-8061 -->

* Se han agregado grupos de acción a `Analytics` módulo. [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-7334 -->

* Actualizado `CheckCheckoutSuccessPageAsRegisterCustomerTest` y `CheckCheckoutSuccessPageAsGuestTest` para cancelar los pedidos creados después de ejecutar las pruebas. [GitHub-28324](https://github.com/magento/magento2/issues/28324)

<!-- ENGCOM-8214 -->

* Eliminado `AdminNavigateToPageGridActionGroup` por redundancia. [GitHub-29838](https://github.com/magento/magento2/issues/29838)

<!-- ENGCOM-8122 -->

* Implementado `ActionGroup` para ir a la página de cierre de compra. [GitHub-29843](https://github.com/magento/magento2/issues/29843)

<!-- ENGCOM-8124 -->

* Implementado `AdminOpenCreateNewCMSPageActionGroup` para navegar hasta crear una nueva página de CMS. [GitHub-29824](https://github.com/magento/magento2/issues/29824)

<!-- ENGCOM-8268 -->

* Se han corregido problemas con la omisión en las pruebas MFTF para la página de CMS para Media Gallery. [GitHub-30164](https://github.com/magento/magento2/issues/30164)

#### Nuevas pruebas

<!-- ENGCOM-7804 -->

* Se ha añadido una prueba para habilitar el correo electrónico a un amigo en el Administrador. [GitHub-29145](https://github.com/magento/magento2/issues/29145)

<!-- ENGCOM-8316 -->

* Un administrador ha añadido una prueba para eliminar un bloque CMS de una cuadrícula. [GitHub-30372](https://github.com/magento/magento2/issues/30372)

<!-- ENGCOM-7933 -->

* Se ha añadido una prueba para aplicar una regla del carro de compras a un solo elemento de paquete. [GitHub-28921](https://github.com/magento/magento2/issues/28921)

<!-- ENGCOM-8075 -->

* Se han añadido pruebas para comprobar si **Utilizado en** La información de una imagen de la Galería multimedia se muestra después de eliminar la entidad. [GitHub-1774](https://github.com/magento/adobe-stock-integration/issues/1774)

#### Nuevos grupos de acción

* `AssertStorefrontCustomerLogoutSuccessPageActionGroup`. [GitHub-29841](https://github.com/magento/magento2/issues/29841) <!-- ENGCOM-8121 -->

* `AdminOpenConfigurationStoresPageActionGroup`. [GitHub-29848](https://github.com/magento/magento2/issues/29848) <!-- ENGCOM-8259 -->

* `ReloadPageActionGroup`. [GitHub-30683](https://github.com/magento/magento2/issues/30683) <!-- ENGCOM-8394 -->

* `StorefrontClickRefundTabCustomerOrderViewActionGroup`. [GitHub-30032](https://github.com/magento/magento2/issues/30032) <!-- ENGCOM-8203 -->

* `AdminOpenAdminThreeDSecurePageActionGroup`. [GitHub-29845](https://github.com/magento/magento2/issues/29845) <!-- ENGCOM-8115 -->

* `AdminCustomerClickFirstRowEditLinkActionGroup`.  [GitHub-29501](https://github.com/magento/magento2/issues/29501) <!-- ENGCOM-8043 -->

* `StorefrontClickAddToCartButtonActionGroup`. [GitHub-29823](https://github.com/magento/magento2/issues/29823) <!-- ENGCOM-8113 -->

* `AdminDeleteTaxRateActionGroup`. [GitHub-29940](https://github.com/magento/magento2/issues/29940) <!-- ENGCOM-8192 -->

* `AdminOpenWebConfigurationPageActionGroup`. [GitHub-29846](https://github.com/magento/magento2/issues/29846) <!-- ENGCOM-8126 -->

* `AdminOpenGeneralConfigurationPageActionGroup`. [GitHub-29847](https://github.com/magento/magento2/issues/29847) <!-- ENGCOM-8114 -->

* `AdminOrderClickSubmitOrderActionGroup`. [GitHub-29649](https://github.com/magento/magento2/issues/29649) <!-- ENGCOM-8023 -->

* `AdminOpenCatalogProductPageActionGroup`. [GitHub-29941](https://github.com/magento/magento2/issues/29941) <!-- ENGCOM-8209 -->

* `AdminClickInvoiceButtonIntoOrderActionGroup`. [GitHub-25399](https://github.com/magento/magento2/issues/25399) <!-- ENGCOM-8210 -->

* `AdminGridBulkActionGroup`. [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminGridColumnShowActionGroup`. [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminOpenIndexManagementPageActionGroup`. [GitHub-29825](https://github.com/magento/magento2/issues/29825) <!-- ENGCOM-8123 -->

* `AdminOpenCatalogSearchTermIndexPageActionGroup`. [GitHub-29844](https://github.com/magento/magento2/issues/29844) <!-- ENGCOM-8128 -->

* `AdminClickAddProductToggleAndSelectProductTypeActionGroup`. [GitHub-30917](https://github.com/magento/magento2/issues/30917) <!-- ENGCOM-8439 -->

* `StorefrontCheckoutClickSaveAddressButtonActionGroup`. [GitHub-30916](https://github.com/magento/magento2/issues/30916) <!-- ENGCOM-8454 -->

* `AdminOpenCurrencyRatesPageActionGroup`. [GitHub-30783](https://github.com/magento/magento2/issues/30783) <!-- ENGCOM-8432 -->

* `AdminClickGetShippingMethodsAndRatesActionGroup`. [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `AdminSelectFixedShippingMethodActionGroup`. [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `StorefrontClickProceedToCheckoutActionGroup`. [GitHub-30926](https://github.com/magento/magento2/issues/30926) <!-- ENGCOM-8438 -->

* `StorefrontOpenMyAccountPageActionGroup`. [GitHub-29842](https://github.com/magento/magento2/issues/29842) <!-- ENGCOM-8143 -->

### Newsletter

<!-- MC-38789-->

* Los usuarios administradores ahora pueden editar una cuenta de cliente como se espera cuando el cliente se suscribe a un boletín informativo en cola. [GitHub-30645](https://github.com/magento/magento2/issues/30645)

<!-- ENGCOM-8034 -->

* La aplicación ahora vuelve a enviar la confirmación de suscripción al boletín informativo si el comprador no confirma su suscripción. [GitHub-28422](https://github.com/magento/magento2/issues/28422)

<!-- ENGCOM-8429 -->

* Ahora puede editar una cuenta de cliente como se espera cuando el cliente está suscrito a un boletín informativo en cola. [GitHub-30645](https://github.com/magento/magento2/issues/30645)

### Métodos de pago

<!-- MC-35161-->

* Los métodos de pago ahora se cargan en el Administrador para todos los sitios web, tal como se espera en una implementación de varias tiendas.

<!-- MC-35152-->

* La aplicación ahora completa pagos de Payflow Pro correctamente cuando el nombre del comprador contiene letras acentuadas. Anteriormente, el pago no se completaba y la aplicación registraba este error: `report.CRITICAL: String to be escaped was not valid UTF-8 or could not be converted`.

#### PayPal

<!-- MC-35692-->

* Los comerciantes ahora pueden realizar correctamente un pedido del administrador después de cambiar de un método de pago que utiliza una tarjeta de crédito a un método de pago que no sea de tarjeta de crédito. Anteriormente, cuando un comerciante hacía clic en **Enviar pedido** botón, el proceso de carga se inició pero nunca se completó y no se realizó el pedido.

<!-- MC-37649-->

* La aplicación ya no crea pedidos duplicados cuando se realiza un pedido con PayPal Express. Anteriormente, cuando un comprador intentaba pagar un pedido con PayPal Express pero PayPal devolvía un error, la aplicación seguía creando el pedido. Esto resultó en pedidos duplicados en el sitio del comerciante. [GitHub-13952](https://github.com/magento/magento2/issues/13952)

<!-- MC-38829-->

* Los informes de liquidación de PayPal ya están disponibles en **Informes** > **Ventas** > **Liquidación con PayPal** como se esperaba. Anteriormente, la aplicación no mostraba estos informes en la cuadrícula del informe de liquidación de PayPal y mostraba este mensaje: `We couldn't find any records`.

<!-- MC-39442-->

* Haciendo clic en **PayPal** botón durante la compra ya no déclencheur un redundante `web-api` llamada. Anteriormente se activaban dos solicitudes, lo que duplicaba el cargo del producto.

<!-- ENGCOM-8173 -->

* Los compradores invitados ahora pueden realizar pedidos de PayPal cuando **Asignación automática al grupo de clientes** está activada. El pago se procesa en la puerta de enlace de PayPal, el pedido se crea en el Magento y el comprador ve la página de agradecimiento del pedido. Anteriormente, el pedido se procesaba correctamente en la puerta de enlace de PayPal, pero no se creó en Magento Open Source. En su lugar, se redirigió al comprador a la página de revisión de pedidos, donde la aplicación mostraba este error: `Failed address validation: %1" error`. [GitHub-25399](https://github.com/magento/magento2/issues/25399)

### Rendimiento

<!-- MC-37705-->

* Problemas de rendimiento en `module-catalog-import-export/Model/Import/Product/Option.php` se han abordado. Se ha reducido el tiempo necesario para exportar o importar más de 100 000 registros. Consulte la [La importación o exportación tarda más de lo esperado con un gran número de opciones de productos](https://support.magento.com/hc/en-us/articles/360050695772) Artículo de la Base de conocimiento.

<!-- MC-37799-->

* `Magento_Csp/Model/BlockCache` se ha refactorizado para reducir el consumo de memoria y la generación de cadenas en caché innecesariamente grandes. Anteriormente, las páginas que incluían scripts y estilos en la lista blanca dinámica solían experimentar problemas de rendimiento. [GitHub-29964](https://github.com/magento/magento2/issues/29964)

<!-- MC-37816 -->

* Hemos mejorado el rendimiento de las exportaciones programadas de catálogos que incluyen más de 100.000 productos que utilizan consumidores.

<!-- MC-38306 -->

* La aplicación ya no vacía la caché de categorías cuando se agrega o guarda un producto deshabilitado en una categoría. Anteriormente, la aplicación vaciaba la caché para categorías relacionadas a pesar del estado del producto, que afectaba al rendimiento del servidor.

<!-- MC-38518 -->

* Se ha mejorado el tiempo de carga de la página para actualizar la cantidad de productos en el carro de compras. Anteriormente, la aplicación ejecutaba varias consultas independientes para cada producto en el carro de compras, lo que aumentaba el tiempo de carga de la página.

<!-- MC-39700 -->

* Se ha agregado un indizador al `Magento_Bulk`  Tabla MySQL, que ha mejorado el rendimiento de las operaciones por lotes.

<!-- MC-38593 -->

* La aplicación ahora almacena en caché los ID secundarios de los productos configurables. Esto ha mejorado el rendimiento de carga de página al reducir el número de solicitudes de base de datos. [GitHub-30585 ](https://github.com/magento/magento2/issues/30585)

<!-- MC-37594 -->

* Se ha mejorado la carga del tablero de administración. Anteriormente, la aplicación mostraba los nombres de las pestañas como una lista antes de que la página terminara de cargarse.

<!-- MC-37417 -->

* Se ha mejorado la administración de la caché de Redis mediante la adición de límites de caducidad para las cachés de diseño. Anteriormente, las cachés de Redis alcanzaban rápidamente la memoria máxima asignada en implementaciones grandes y la aplicación arrojaba errores en las operaciones de escritura.

<!-- ENGCOM-8016 -->

* El rendimiento de la desprotección se ha mejorado eliminando una consulta de base de datos redundante en `app/code/Magento/Catalog/Model/CategoryLink.php`. [GitHub-29453](https://github.com/magento/magento2/issues/29453)

<!-- ENGCOM-8290 -->

* `Magento\Framework\DB\Adapter\Pdo\Mysql->isTableExists` se ha refactorizado para mejorar el rendimiento. Llamadas redundantes a `SHOW TABLE STATUS` para comprobar la existencia de una tabla se han reducido. [GitHub-29662](https://github.com/magento/magento2/issues/29662)

<!-- ENGCOM-8258 -->

* `getPageLayoutsConfig` ahora se guarda en caché, lo que mejora el rendimiento del generador de configuración. [GitHub-29546](https://github.com/magento/magento2/issues/29546)

### Persistente

<!-- MC-36647 -->

* Los compradores ya no pueden realizar un pedido después de que la cookie de sesión haya caducado cuando el carro de compras persistente esté habilitado. En su lugar, la aplicación muestra la página de inicio de sesión para que el comprador pueda iniciar sesión. Anteriormente, la aplicación realizaba el pedido. La aplicación no validó correctamente el cliente persistente cuando `PHPSESSID` habían caducado, y `customerSession` se ha vuelto a crear a partir de la información persistente.

<!-- MC-39127-->

* La aplicación ahora muestra el mensaje de bienvenida como se espera después de que un comprador inicie sesión en una tienda en la que esté habilitado el carro de compras persistente. Anteriormente, la aplicación mostraba el **¿Tú no?** después de iniciar sesión.

<!-- MC-38269-->

* La aplicación ya no muestra el **¿Tú no?** cuando un cliente selecciona la variable **Recordar mis datos** opción al iniciar sesión en una implementación en la que esté habilitado el carro de compras persistente.

<!-- MC-37109-->

* La aplicación ya no muestra el contenido del carro de compras de un cliente una vez caducada la sesión del cliente. Anteriormente, la aplicación mostraba este error cuando un cliente invitado intentaba cerrar la compra cuando el carro de compras persistente estaba habilitado: `No such entity with cartid = 0`.

### Precio

<!-- MC-34394-->

* Las actualizaciones de precios asíncronas consecutivas ya no interfieren entre sí y se asigna el estado correcto a cada operación. Anteriormente, si fallaba una actualización de precios asincrónica, todas las siguientes actualizaciones de precios asincrónicas fallaban hasta que se reiniciara el consumidor de cola correspondiente. [GitHub-27865](https://github.com/magento/magento2/issues/27865)

### Informes

<!-- MC-36652 38925-->

* **Informes** > **Marketing** > **Productos en carros de compras** ahora solo muestra el registro en el ámbito permitido del usuario que está generando el informe. Anteriormente, todos los datos estaban disponibles para todos los ámbitos.

<!-- MC-38074-->

* La aplicación ahora utiliza la moneda especificada en el ámbito de función del comerciante que genera el informe al mostrar la moneda del producto en el informe Productos en el carro de compras.

<!-- MC-37934-->

* Las funciones de producto Vistos recientemente y Comparados recientemente ahora muestran estadísticas para diferentes tiendas y sitios web en el administrador, tal como se espera en una implementación de varias tiendas. Anteriormente, estas funciones no tenían en cuenta todas las tiendas o sitios web.

<!-- MC-37217-->

* Los informes Precios en pedido ahora utilizan el símbolo de divisa correcto.

<!-- ENGCOM-8314 -->

* La aplicación ahora comprueba la existencia de un token cuando un usuario hace clic en el panel de administración **Ir al informe avanzado** botón.  Si el token existe, la aplicación muestra la página Informes avanzados. Si el token no está configurado, la aplicación muestra una página informativa en la Guía del usuario. [GitHub-25411](https://github.com/magento/magento2/issues/25411)

### Críticas

<!-- MC-37117-->

* La página Nueva revisión ahora se carga según lo esperado al hacer clic en **Nueva revisión** botón en Administración **Marketing** > **Todas las críticas**. Al hacer clic en un producto de esta página, se abre el nuevo formulario de revisión esperado para ese producto.

<!-- ENGCOM-8383 -->

* La aplicación ya no genera este error cuando intenta editar una solicitud del administrador **Marketing**  >  **Todas las críticas**: `Uncaught TypeError: Event.observe is not a function`.  [GitHub-30388](https://github.com/magento/magento2/issues/30388)

### Ventas

<!-- MC-36219-->

* El `order_created_at` de la columna `sales_shipment_grid` ahora se actualiza según lo esperado después de cada actualización.

<!-- MC-36405-->

* Ahora puede reordenar correctamente un producto con una fecha de opciones personalizadas de una tienda para la que **Usar calendario JavaScript** está activada. Anteriormente, cuando intentaba volver a ordenar, la aplicación no agregaba el elemento al carro de compras y mostraba este error: `Could not add the product with SKU "simp1" to the shopping cart: Please specify date required option(s).`

<!-- MC-36533-->

* La aplicación ya no cierra inmediatamente un pedido cuando un comprador extrae un pedido que consta de un producto virtual con un coste total de 0 $ en implementaciones en las que el método de extracción de subtotales cero está habilitado.

<!-- MC-36755-->

* La aplicación ya no archiva una solicitud antes de procesarla. Anteriormente, la acción de selección múltiple en la cuadrícula de orden de administración afectaba a los pedidos no seleccionados.

<!-- MC-37371-->

* La cuadrícula de notas de crédito ahora muestra el símbolo de moneda correcto cuando el Rial saudí (SAR) está establecido como moneda base.

<!-- MC-37880-->

* La aplicación ahora muestra de forma consistente la información de la dirección de envío según lo esperado en la página de pedidos durante el cierre de compra.

<!-- MC-38666-->

* El valor de `total_qty` ahora coincide con el valor de `total_qty_ordered` en facturas de ventas.

<!-- MC-38717-->

* El envío asincrónico de correos electrónicos de ventas ahora envía correos electrónicos solo para los pedidos creados después de la fecha de la última actualización. Anteriormente, la aplicación no filtraba los correos electrónicos por fecha cuando el envío asincrónico estaba habilitado.

<!-- MC-39135-->

* La aplicación ahora envía el correo electrónico de factura según lo esperado cuando se realiza un pedido desde el administrador.

<!-- MC-38917-->

* La aplicación ahora borra los datos de pedidos existentes durante una sesión en la que un comerciante crea un nuevo pedido para un cliente desde el administrador.

<!-- MC-38915-->

* Ahora puede cambiar el grupo de clientes para los nuevos clientes que se crean mediante un pedido de administrador cuando **Habilitar la asignación automática al grupo de clientes** está activada. También puede asignar un grupo de clientes en función de la validación de IVA. Anteriormente, al validar el número de IVA, el objeto de solicitud no comprobaba la solicitud asignada `group_id`. De forma predeterminada, utiliza el valor predeterminado `group_id`.

<!-- MC-37539-->

* La aplicación ya no cambia el estado de un pedido personalizado con `Suspected Fraud` estado a `Processing` después de que un comerciante cree un envío parcial utilizando la API de REST.

### Regla de ventas

<!-- MC-34793-->

* Los códigos de cupones que se han aplicado en función del método de envío ya no se aplican cuando un comprador cambia el método de envío. Anteriormente, la aplicación no borraba los códigos de cupones cuando los compradores cambiaban de método de envío.

<!-- MC-34649-->

* Los compradores no pueden aplicar un código de cupón con una frecuencia superior a **Usos por cliente** permisos de configuración. Anteriormente, si un comprador tenía varias ventanas de navegador abiertas y realizaba varios pedidos simultáneamente, cada pedido recibía el descuento, aunque la variable **Usos por cliente** la configuración tenía un valor de **1**.

### Buscar {#search-heading}

<!-- MC-35095-->

* Elasticsearch ya no genera un error de modificador desconocido cuando un comprador busca un sinónimo de búsqueda. Anteriormente, el escape carecía de un símbolo de barra diagonal de escape en las expresiones regulares, lo que resultaba en un error grave.

<!-- MC-37577-->

* La búsqueda avanzada ya no devuelve los elementos secundarios de los productos configurables como resultados de búsqueda individuales cuando los productos secundarios se configuraron con la visibilidad establecida en **No visible individualmente**.

<!-- MC-37954-->

* El tipo de nombres de productos del Elasticsearch en los resultados de búsqueda ya no distingue entre mayúsculas y minúsculas.

<!-- ENGCOM-8329 -->

* La página de resultados de búsqueda ahora se almacena en caché como se espera cuando el **establezca el Número de resultados de búsqueda principales en caché en 0** La configuración está habilitada en Administración **Tiendas**  >  **Configuración**  >  **Catálogo**  >  **Catálogo**  > **Búsqueda en catálogo**.

<!-- MC-36807-->

* El indexador de búsqueda en el catálogo ahora se ejecuta sin arrojar un error debido al límite del campo del Elasticsearch. Anteriormente, la aplicación arrojaba este error: `Limit of total fields [xxx] in index [m24dev_product_1_v10] has been exceeded`.

<!-- MC-35491-->

* El rendimiento de la búsqueda en el catálogo ha mejorado. Desactivando **Activar sugerencias de búsqueda** (**Tiendas** > **Configuración** > **Catálogo** > **Búsqueda en catálogo** ) funciona según lo esperado. Anteriormente, la aplicación consultaba MySQL `search_query` en lugar del Elasticsearch para las sugerencias de búsqueda autocompletada. [GitHub-25534](https://github.com/magento/magento2/issues/25534)

<!-- MC-35256-->

* El Elasticsearch ahora filtra los precios del producto igual que MySQL. El tipo de campo `price_*`  se cambió de `float` hasta `double` en el índice del Elasticsearch para mejorar la precisión y corregir un error de punto flotante.

<!-- ENGCOM-8393 -->

* Se ha agregado un detector de eventos de keydown al administrador para activar el formulario de búsqueda global cuando se introduce una barra diagonal. [GitHub-29551](https://github.com/magento/magento2/issues/29551)

<!-- MC-24217-->

* El Elasticsearch ya no genera un error y, en su lugar, no muestra ningún producto como se espera cuando un `string` se utiliza para filtrar productos por atributo con un `integer` o `decimal` tipo de servidor. Anteriormente, la aplicación mostraba este error en `exception.log`: `number format exception`.

<!-- ENGCOM-8303 -->

* El Elasticsearch ya no genera una excepción cuando un término de búsqueda contiene una  `/`.  [GitHub-25886](https://github.com/magento/magento2/issues/25886), [GitHub-25110](https://github.com/magento/magento2/issues/25110)

* La búsqueda ahora está desactivada tal como se espera para un grupo de clientes seleccionado de la consulta de productos cuando la variable **No permitir búsqueda en el catálogo por** La configuración de en Permisos generales de categorías está habilitada. [GitHub-29927](https://github.com/magento/magento2/issues/29927)

<!-- ENGCOM-8466 -->

* Los resultados de la búsqueda ya no incluyen varias comillas de la misma palabra. [GitHub-30104](https://github.com/magento/magento2/issues/30104)

### Envío

<!-- MC-38247 -->

* El proceso de cierre de compra ya no falla cuando una interrupción de la red interrumpe la conexión con el método de envío DHL. La aplicación muestra otros métodos de envío disponibles. Anteriormente, el proceso de cierre de compra se bloqueaba cuando se interrumpió la conexión con el envío de DHL y la aplicación mostraba este error: `Sorry, no quotes are available for this order at this time`. [GitHub-29902](https://github.com/magento/magento2/issues/29902)

<!-- MC-35194-->

* Los campos que describen el método de envío de UPS en Administración **Tiendas** > **Configuración** > **Ventas** > **Métodos de envío** ahora están activados según lo esperado.

<!-- MC-35633-->

* Envíos creados a través del POST `/rest/V1/shipment` el punto final ahora actualiza las solicitudes correctamente. Anteriormente, la aplicación creaba un envío, pero el estado del envío permanecía en el estado de procesamiento.

<!-- MC-37120-->

* La aplicación ya no elimina los productos simples del carro de compras cuando se elimina otro producto del carro de compras antes de cerrar la compra con Enviar a varias direcciones. [GitHub-30259](https://github.com/magento/magento2/issues/30259)

<!-- MC-38031-->

* La página Revisión de Pedidos ahora muestra el importe de impuestos antes del importe de envío como se espera para los pedidos que se envían a varias direcciones.

<!-- ENGCOM-8257 -->

* El seguimiento del envío de UPS ahora indica un estado de `Delivered On` solo cuando se ha entregado un paquete. [GitHub-30032](https://github.com/magento/magento2/issues/30032)

<!-- MC-38825-->

* La aplicación ahora muestra el subtotal correcto del carro de compras para los pedidos que contienen un producto virtual cuando el comprador vuelve al carro de compras desde la comprobación con varias direcciones.

<!-- MC-38682-->

* Los comerciantes ahora pueden crear una etiqueta de envío desde la página de envío para un pedido existente que utilice envío de FedEx cuando el agrupamiento de JavaScript esté habilitado. Anteriormente, la aplicación arrojaba un error cuando el comerciante hacía clic en **Crear etiqueta de envío** botón.

<!-- MC-36953-->

* El vínculo de seguimiento de envío del correo electrónico de confirmación de envío enviado a los clientes ahora funciona según lo esperado. Anteriormente, este vínculo devolvía un error 404.

<!-- ENGCOM-8025 -->

* La aplicación ahora muestra un mensaje de error informativo cuando un comprador cierra la compra con varias direcciones y, a continuación, elimina todos los productos que no sean un producto virtual. [GitHub-25595](https://github.com/magento/magento2/issues/25595)

<!-- ENGCOM-8253 -->

* Ahora puede crear una etiqueta de envío como se espera para un pedido parcial. Anteriormente, cuando se intentaba crear una etiqueta de envío para un solo artículo de un pedido, la aplicación añadía todos los productos al paquete y la validación fallaba. [GitHub-29552](https://github.com/magento/magento2/issues/29552)

<!-- ENGCOM-8154 -->

* La validación del método de envío ya no se omite al llamar a `/V1/guest-carts/:cartId/totals-information`. [GitHub-25147](https://github.com/magento/magento2/issues/25147)

### Sitemap

<!-- MC-37306-->

* Mapas del sitio generados por `cron` ahora incluya las direcciones URL de imagen correctas. Anteriormente, la ruta de la imagen en caché generada era incorrecta en implementaciones de varias tiendas.

### Almacenar

<!-- ENGCOM-7543 -->

* El Administrador y el conmutador de tienda principal ahora reflejan los cambios realizados en el orden de clasificación de tiendas en el Administrador. [GitHub-13401](https://github.com/magento/magento2/issues/13401)

<!-- ENGCOM-8274 -->

* La aplicación ahora crea direcciones URL correctas para categorías y productos después de cambiar la clave URL de nivel superior de una vista de tienda. Anteriormente, cuando el árbol de categorías de una vista de tienda contenía cambios  `url_keys`Sin embargo, si una clave de categoría no ha cambiado pero sí la clave de los elementos principales de la categoría, el código original utilizaría la vista de tienda predeterminada de la categoría al crear direcciones URL. [GitHub-28633](https://github.com/magento/magento2/issues/28633)

### Reglas de destino

<!-- MC-34998-->

* Se ha optimizado la carga de páginas de detalles del producto. Hemos añadido índices para tablas de base de datos que optimizan las consultas de condiciones de regla de destinatario para muchos casos.

### Impuestos

<!-- MC-37666-->

* La validación del IVA en un pedido de invitado ya no hace que la aplicación guarde la oferta con una clase de impuestos de cliente incorrecta. [GitHub-30018](https://github.com/magento/magento2/issues/30018)

<!-- MC-37761-->

* Los pedidos que se envían a varias direcciones ahora se pueden guardar durante el cierre de compra cuando se configura FTP. Anteriormente, después de completar un pedido para varias direcciones, la aplicación mostraba una página en blanco en lugar de la página de éxito del pedido.

<!-- ENGCOM-8158 -->

* Las páginas de detalles de productos de la tienda ahora muestran los precios nuevos y antiguos con y sin impuestos según lo esperado. [GitHub-27500](https://github.com/magento/magento2/issues/27500), [GitHub-11998](https://github.com/magento/magento2/issues/11998)

### Prueba

<!-- MC-37364-->

* `bin/magento dev:tests:run` ahora inicia las siguientes pruebas según lo esperado: all, unit, integration, integration-all, static, static-all, integration, legacy y default.

<!-- MC-38488-->

* `AdminMediaGalleryInsertLargeImageFileSizeTest` se ha refactorizado.

<!-- ENGCOM-8158 -->

* Las pruebas unitarias ahora son compatibles con PHPUnit 8. [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-8009 -->

* `\Magento\TestFramework\TestCase\WebapiAbstract` ahora contiene una función que admite la comparación de matrices anidadas grandes de resultados esperados y reales en pruebas. Ahora se pueden ignorar las claves irrelevantes del resultado. [GitHub-29498](https://github.com/magento/magento2/issues/29498)

<!-- ENGCOM-8024 -->

* `AdminMediaGalleryCatalogUiEditCategoryGridPageTest` ya no falla aleatoriamente. [GitHub-1764](https://github.com/magento/adobe-stock-integration/issues/1764)

<!-- ENGCOM-8041 -->

* `dev/tests/integration/testsuite/Magento/Customer/Controller/AccountTest` se ha mejorado. (`assert` ahora se basa en `XPath` selector en lugar de `assertStringContainsString`.) [GitHub-29700](https://github.com/magento/magento2/issues/29700)

<!-- ENGCOM-8017 -->

* Se ha añadido cobertura de prueba para `AdminAnalytics` módulo. [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-8266 -->

* Las pruebas funcionales de integración y API ahora son compatibles con PHPUnit 9.3. [GitHub-30146](https://github.com/magento/magento2/issues/30146)

<!-- MC-35798 -->

* Problemas corregidos con GraphQL `testRequestCacheTagsForCategoryListOnMultipleIds` prueba. [GitHub-29372](https://github.com/magento/magento2/issues/29372)

<!-- ENGCOM-7762 -->

* Los valores de encabezado que incluyen direcciones URL ahora se analizan correctamente en `ApiFunctional TestFramework`. [GitHub-26425](https://github.com/magento/magento2/issues/26425)

<!-- MC-35798 8109-->

* Problemas corregidos con GraphQL `testRequestCacheTagsForCategoryListOnMultipleIds` prueba. [GitHub-29372](https://github.com/magento/magento2/issues/29372)

<!-- ENGCOM-8382 -->

* `—no-tablespaces` se ha añadido a todas las ocurrencias de `mysqldump`, que permite ejecutar pruebas de integración sin el `PROCESS` (requerido desde MySQL 5.7.31 / 8.0.21 para ejecutarse) `mysqldump` de forma predeterminada). [GitHub-30566](https://github.com/magento/magento2/issues/30566)

### Tema

<!-- ENGCOM-8419 -->

* Un nuevo `--no-parent` se ha añadido el indicador a `bin/magento setup:static-content:deploy` que impide que se compilen los elementos primarios de una temática. Este nuevo indicador le permite mejorar significativamente el rendimiento del proceso de implementación de contenido estático al evitar una compilación innecesaria. Tenga en cuenta que este nuevo indicador no funciona al utilizar el `compact` estrategia. [GitHub-30184](https://github.com/magento/magento2/issues/30184)

<!-- MC-37630 -->

* La configuración de diseño ya no genera operaciones DDL. Anteriormente, cuando se actualizaba la configuración de diseño, la aplicación generaba instrucciones DDL que podían almacenar en déclencheur errores de MySQL.

<!-- ENGCOM-8112 -->

* Código redundante en el `Magento_ConfigurableProduct` se ha eliminado del módulo de en la temática Administrador.  [GitHub-29857](https://github.com/magento/magento2/issues/29857)

<!-- ENGCOM-8144 -->

* Se han eliminado la navegación de estilos menos redundantes y las propiedades no utilizadas en la temática en blanco. [GitHub-29914](https://github.com/magento/magento2/issues/29914)

<!-- ENGCOM-8285 -->

* Se ha agregado la funcionalidad de navegación contraíble a la temática En blanco en la vista móvil. [GitHub-30237](https://github.com/magento/magento2/issues/30237)

<!-- ENGCOM-7803 -->

* Se ha optimizado la carga de fuentes web para temáticas.  [GitHub-29526](https://github.com/magento/magento2/issues/29526)

<!-- ENGCOM-8068 -->

* Los desarrolladores ahora pueden especificar el tipo de fuente al declarar una fuente personalizada en un tema. [GitHub-29719](https://github.com/magento/magento2/issues/29719)

### Traducción y configuraciones regionales

<!-- MC-36836 -->

* El Selector de fecha de cuadrícula de pedidos del administrador ahora funciona según lo esperado cuando la configuración regional del administrador es árabe (`ar_SA - Saudi Arabia`).

<!-- MC-38476 -->

* La aplicación ya no muestra un mensaje de error cuando un comprador introduce una dirección argentina con un código postal válido al registrar o añadir una nueva dirección. Anteriormente, la aplicación mostraba este error: `Provided Zip/Postal Code seems to be invalid. Example: 1234. If you believe it is the right one you can ignore this notice.`

<!-- MC-38663-->

* La aplicación ya no genera un error cuando un comprador introduce un código postal de cinco dígitos para una dirección coreana.

<!-- ENGCOM-8244 -->

* Se ha agregado apoyo para las regiones de Uruguay definidas en [ISO 3166-2:UY](https://en.wikipedia.org/wiki/ISO_3166-2:UY). [GitHub-29729](https://github.com/magento/magento2/issues/29729)

<!-- ENGCOM-8220 -->

* `zip_codes.xml` se ha actualizado para aplicar ocho dígitos a los códigos postales brasileños. [GitHub-29984](https://github.com/magento/magento2/issues/29984)

<!-- ENGCOM-8304 -->

* Se ha mejorado la localización de las frases no localizadas restantes. [GitHub-11175](https://github.com/magento/magento2/issues/11175)

<!-- ENGCOM-8380 -->

* Ahora se puede traducir el marcador de posición de entrada de búsqueda de cuadrícula. [GitHub-30510](https://github.com/magento/magento2/issues/30510)

<!-- ENGCOM-8018 -->

* La aplicación ahora descarga módulos JavaScript de traducciones en línea solo cuando están activados.  [GitHub-29553](https://github.com/magento/magento2/issues/29553)

### IU

<!-- MC-38509-->

* El **Crear una cuenta** en la página Crear nueva cuenta permanece activo cuando un comprador introduce datos no válidos. Anteriormente, este botón estaba desactivado, lo que impedía a los compradores volver a intentar crear una cuenta después de cometer un error. Este era un problema conocido en 2.4.1. [GitHub-30513](https://github.com/magento/magento2/issues/30513)

<!-- MC-38698-->

* Se ha mejorado la carga de la cuadrícula de envío en la página Editar pedido de administrador.

<!-- MC-37870-->

* La aplicación ahora muestra el  **Igual Que Dirección De Facturación** casilla de verificación según lo esperado en la página de pedidos cuando el SKU ha agregado productos al carro de compras.

<!-- ENGCOM-8007 -->

* La clase CSS que definió la anchura limitada ahora se aplica como se espera a la **Hora de inicio** campos de administración **Almacenar**  >  **Configuración**  >  **Catálogo**  >  **Mapa del sitio XML**  >  **Configuración de generación**.  [GitHub-29496](https://github.com/magento/magento2/issues/29496)

<!-- ENGCOM-7992 -->

* Se han corregido los problemas de visualización con la etiqueta de casilla de verificación Términos y condiciones.  [GitHub-24060](https://github.com/magento/magento2/issues/24060)

<!-- ENGCOM-7948 -->

* La aplicación ya no muestra el código CSS de un bloque de precios de nivel en la página del producto cuando los precios de nivel no están disponibles. [GitHub-29194](https://github.com/magento/magento2/issues/29194)

<!-- ENGCOM-8084 -->

* La posición de los botones en la página de detalles de la vista de imagen se ha reorganizado para ajustarse a las directrices de la interfaz de usuario.  [GitHub-1783](https://github.com/magento/adobe-stock-integration/issues/1783)

<!-- ENGCOM-8342 -->

* El campo de texto del código de cupón ahora se muestra con la anchura adecuada en los exploradores Internet Explorer/EDGE.

<!-- ENGCOM-7630 -->

* El `@button__border-radius` ahora se define en la variable `lib/web/css/source/lib/variables/_buttons.less` biblioteca.  `border-radius` tiene un valor predeterminado de `3px`. Anteriormente, `border-radius` estaba codificado.  [GitHub-28674](https://github.com/magento/magento2/issues/28674)

<!-- ENGCOM-8067 -->

* El botón de envío de búsqueda (lupa) del campo de búsqueda mini ahora está desactivado hasta que se alcance la longitud mínima de la cadena de búsqueda. [GitHub-29704](https://github.com/magento/magento2/issues/29704)

<!-- MC-38807-->

* El **Previsualizar plantilla** ahora funciona como se espera en la página Editar cola.

<!-- MC-31892-->

* La aplicación ahora conserva el valor de un atributo cuando se mueve el atributo de un grupo a otro.

<!-- ENGCOM-8085 -->

* Se ha añadido una variable de peso de fuente a `lib/web/css/source/lib/variables/_typography.less`. [GitHub-29778](https://github.com/magento/magento2/issues/29778)

<!-- ENGCOM-8211 -->

* La visibilidad del filtro ahora funciona con la visibilidad de la columna como se espera en las cuadrículas de administración.  [GitHub-30345](https://github.com/magento/magento2/issues/30345)

<!-- ENGCOM-8152 -->

* Las opciones de componentes de selección de IU ya no están visibles cuando `this.disabled(true)` está configurado. [GitHub-29098](https://github.com/magento/magento2/issues/29098)

<!-- ENGCOM-7901 -->

* El `@font-family-name__base` ya no se utiliza al cargar la fuente Open Sans. [GitHub-29515](https://github.com/magento/magento2/issues/29515)

<!-- ENGCOM-8120 -->

* El atributo WAI-ARIA `aria-atomic="true"` se ha añadido a la etiqueta contenedora de errores. [GitHub-29560](https://github.com/magento/magento2/issues/29560)

<!-- ENGCOM-8175 -->

* Las cuadrículas de componentes de la IU ahora muestran un recuento preciso de los elementos seleccionados. Anteriormente, las cuadrículas indicaban un número incorrecto de selecciones cuando una búsqueda por palabra clave seleccionaba todos los elementos de cuadrícula y el comprador posteriormente anulaba la selección de algunos elementos antes de seleccionar la casilla de verificación del encabezado. [GitHub-29968](https://github.com/magento/magento2/issues/29968)

<!-- ENGCOM-8118 -->

* La aplicación ya no muestra el HTML no procesado en las páginas de resumen de facturas y envíos. [GitHub-29958](https://github.com/magento/magento2/issues/29958)

<!-- ENGCOM-8066 -->

* Clic **Opciones** en el Administrador **Tiendas**  >  **Tipos de cambio**  ahora dirige a los usuarios a la sección de opciones de moneda expandidas de la página de configuración del sistema. [GitHub-29336](https://github.com/magento/magento2/issues/29336)

<!-- ENGCOM-8361 -->

* Compatibilidad mejorada para mostrar un widget en función de otra condición para `adminhtml` widgets al utilizar un tipo de widget de selector. [GitHub-13316](https://github.com/magento/magento2/issues/13316), [GitHub-7252](https://github.com/magento/magento2/issues/7252), [GitHub-6868](https://github.com/magento/magento2/issues/6868)

<!-- ENGCOM-8336 -->

* Se ha mejorado el relleno de texto en los cuadros de diálogo emergentes de confirmación de la temática de Luma. [GitHub-30452](https://github.com/magento/magento2/issues/30452)

### Bóveda

<!-- MC-39109-->

* El `Vault` ahora reconoce los códigos de método de pago de la solicitud del servicio de gestión de información de pago. Anteriormente, cuando un comprador realizaba un pedido con una tarjeta de crédito de Braintree guardada, la aplicación arrojaba este error incluso cuando se utilizaba un método de pago válido: `The requested Payment Method is not available`.

<!-- ENGCOM-7977 -->

* El banner que la aplicación muestra en la página Admin Login as Customer ahora permanece en la parte superior de la página cuando el usuario se desplaza. [GitHub-29354](https://github.com/magento/magento2/issues/29354)

### Vértice

* Las sugerencias de direcciones ahora se eliminan según lo esperado cuando se modifica una dirección.

* Se ha resuelto una condición de carrera que impedía que algunos clientes guardaran su dirección en el panel de cuenta.

* La validación de direcciones de vértice ya no agrega la página Editar dirección a la caché de página completa en determinadas condiciones.

* El impuesto calculado por vértice ahora se considera cuando el envío gratuito está configurado para un importe que incluye impuestos.

### Marco de API web

<!-- MC-23904 ENGCOM-8421-->

* Ahora puede utilizar el POST `V1/invoice/:invoiceId/refund` para reembolsar una factura que tenga una cantidad cero de productos y gastos de envío cero (por ejemplo, `{"items": [{"qty": 0, "orderItemId": 6, "extensionAttributes": {}}], "appendComment": false, "notify": true, "isOnline": true, "arguments": {"adjustment_negative": 0.0, "adjustment_positive": 0.99, "shipping_amount": 0}}.` ) Anteriormente, la aplicación arrojaba este error: `You can't create a creditmemo without products`. [GitHub-23069](https://github.com/magento/magento2/issues/23069)

<!-- MC-33732 -->

* Ahora puede utilizar el POST `V1/categories` para crear o actualizar una categoría. Anteriormente, la aplicación no guardaba el valor si la variable `default_sort_by` el valor se ha establecido como una matriz. Si la variable `default_sort_by` se ha establecido como una cadena, la aplicación ha devuelto este error: `Error occurred during \"custom_attributes\" processing. Attribute \"default_sort_by\" has invalid value. The \"string\" value's type is invalid. The \"string[]\" type was expected. Verify and try again.`

<!-- MC-35740 -->

* Uso del POST `V1/invoices/:id/capture` para capturar la información de pago ahora funciona según lo esperado. Anteriormente, la aplicación autorizaba el pedido, pero lo capturaba únicamente en el sitio de la pasarela de pago.

<!-- MC-37794 -->

* Cuando use POST `V1/order/:orderId/ship` para crear un envío parcial, el punto final devuelve el número correcto de productos enviados.

<!-- MC-38425-->

* Facturas creadas con el POST `V1/order/:orderID/invoice` ahora refleja con precisión el pago parcial por crédito de tienda. Anteriormente, cuando se pagaba parcialmente un pedido con crédito de tienda, la factura se creaba sin tener en cuenta el crédito de tienda.

<!-- MC-36830-->

* El GET `rest/all/V1/categories` y GET `rest/all/V1/categories?rootCategoryId=2` las llamadas ahora devuelven rellenadas `name` y `product_count` según lo esperado para todas las categorías del árbol. Anteriormente, los valores de los campos de categoría estaban vacíos. El complemento solucionador de nombres de tabla devolvió un nombre de tabla incorrecto para recuperar el recuento de productos por categoría.

<!-- ENGCOM-8286 -->

* El PUT `V1/categories/:id` El punto de conexión ahora almacena los datos necesarios para crear redirecciones 301 para claves URL de categoría cuando el `save_rewrites_history` se ha proporcionado un atributo personalizado. [GitHub-29174](https://github.com/magento/magento2/issues/29174), [GitHub-30240](https://github.com/magento/magento2/issues/30240)

### Lista de deseos

<!-- MC-33626-->

* Los compradores ahora pueden agregar un producto a una lista de deseos cuando el producto se asigna a un origen de inventario personalizado. [GitHub-3018](https://github.com/magento/inventory/issues/3018)

<!-- MC-35416-->

* Los administradores ahora pueden acceder a la página Administrar carro de compras desde la página Administrador del cliente después de que un cliente haya agregado un producto a su lista de deseos desde la tienda. Anteriormente, la aplicación mostraba el siguiente error cuando el administrador hacía clic en **Administrar carro de compras** botón: `An error has occurred. See error log for details`.

<!-- MC-35573-->

* El **Añadir al carro de compras** El botón de la página de lista de deseos compartidos ahora funciona según lo esperado para usuarios anónimos, invitados y usuarios que no han iniciado sesión.

<!-- ENGCOM-8062 -->

* La aplicación ahora muestra las opciones de atributos de producto configurables seleccionadas en la página de la lista de deseos según lo esperado.  [GitHub-24091](https://github.com/magento/magento2/issues/24091),  [GitHub-22503](https://github.com/magento/magento2/issues/22503)

<!-- ENGCOM-7779 -->

* Implementado `ActionInterface` para `\Magento\Wishlist\Controller\Shared\Allcart`. [GitHub-29537](https://github.com/magento/magento2/issues/29537)

## Problemas conocidos

**Problema**: La `[magento_root]/index.php` se ha eliminado y la aplicación ahora se ejecuta desde `/pub` de forma predeterminada para las configuraciones de Apache. Las tiendas que se proporcionan desde subcarpetas no funcionarán según lo esperado y pueden mostrar errores 404. **Solución**: utilice enlaces simbólicos para emular la instalación en una subcarpeta. El siguiente ejemplo utiliza `https://shop01.com/shop/` para ilustrar cómo utilizar un enlace simbólico para emular una instalación en una subcarpeta.

1. Crear un subdirectorio para `https://shop01.com/shop/`:

   ```bash
   mkdir magento_root/pub/shop01
   ```

   ```bash
   cd magento_root/pub/shop01
   ```

1. Cree enlaces simbólicos para los directorios principales del almacén en el directorio recién creado:

   ```bash
   ln -s ../media media
   ```

   ```bash
   ln -s ../static static
   ```

   ```bash
   ln -s ../../../pub pub
   ```

   ```bash
   ln -s ../.htaccess .htaccess
   ```

   ```bash
   ln -s ../health_check.php health_check.php
   ```

1. Crear un `index.php` dentro del nuevo directorio (`magento_root/pub/shop01/index.php`) y añada este contenido:

```php
   <?php
   require realpath(__DIR__) . '/../../../app/bootstrap.php';

   switch ($_SERVER['HTTP_HOST']) {
       case 'shop01.com':
       case 'www.shop01.com':
           $params = $_SERVER;
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_CODE] = 'shop01';
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_TYPE] = 'website';
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $params);
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
           break;

       default:
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $_SERVER);
           /** @var \Magento\Framework\App\Http $app */
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
       break;
   }
```

1. Configure el servidor Apache para que apunte al nuevo subdirectorio. Las configuraciones de implementación pueden variar considerablemente. Este es un ejemplo de configuración del servidor:

```xml
   <VirtualHost *:80>
       DocumentRoot "magento_root/pub/shop1"
       ServerName shop01.com
   </VirtualHost>
```

**Problema**: La aplicación no envía información de pago como se espera cuando un comprador introduce por primera vez un código correcto en el campo CAPTCHA de la página Pago, pero muestra el siguiente error:  `There has been an error processing your request`. Esto solo ocurre cuando el comprador intenta realizar el pedido sin introducir el código CAPTCHA o introduciéndolo de forma incorrecta.  **Solución**: Actualice la página. <!-- MC-40506-->

**Problema**: la aplicación crea un pedido en Braintree como se espera cuando un comprador hace clic en **Pagar con Venmo**, pero no crea el orden en el Administrador. Consulte la [2.4.2 problema conocido: el pago Venmo de Braintree no funciona](https://support.magento.com/hc/en-us/articles/360054662652/) Artículo de la Base de conocimiento.  <!-- BUNDLE-2894-->

**Problema**: no puede utilizar el `addConfigurableProductToCart` Mutación de GraphQL para agregar un producto configurable a un carro de compras en una vista de tienda no predeterminada en una implementación de varias tiendas que ejecuta Inventory. (Las tiendas de Luma no se ven afectadas). la aplicación muestra este error: `Could not add item to cart. Please check required options and try again`. **Solución**: utilice el `addProductsToCart` en su lugar. [GitHub-31660](https://github.com/magento/magento2/issues/31660)<!-- PWA-1298-->

## Contribuciones comunitarias

Agradecemos a la comunidad Magento Open Source en general y quisiéramos agradecer sus aportaciones a esta versión.

El equipo de ingeniería de la comunidad [Colaboradores Magento](https://magento.com/magento-contributors) mantiene una lista de las personas y socios que más contribuyen por mes, trimestre y año. Desde esa página de colaboradores, puede seguir los vínculos a sus PR fusionadas en GitHub.

### Contribuciones de socios

En el cuadro siguiente se destacan las contribuciones de los asociados. Esta tabla enumera el socio que contribuyó con la solicitud de extracción, la solicitud de extracción externa y el número de problema de GitHub asociado a ella (si está disponible).

{{$include /help/_includes/release-notes/engcomm-2-4-2-partner.md}}

### Contribuciones de colaborador individual

La siguiente tabla identifica las contribuciones de los miembros de nuestra comunidad. En esta tabla se enumeran las solicitudes de extracción externas, el número de problema de GitHub asociado a ellas (si está disponible) y el miembro de la comunidad que contribuyó con la solicitud de extracción.

{{$include /help/_includes/release-notes/engcomm-2-4-2-issues.md}}

### Requisitos del sistema

Nuestra pila de tecnología está construida sobre PHP y MySQL. Para obtener más información, consulte [Requisitos del sistema](../../../installation/system-requirements.md).

### Instrucciones de instalación y actualización

Puede instalar Magento Open Source 2.4.2 mediante [Compositor](../../../installation/composer.md).

## Kits de herramientas de migración

La herramienta de migración de datos ayuda a transferir los datos de almacén de Magento 1.x existentes al Magento 2.x. Esta interfaz de línea de comandos incluye funciones de verificación, seguimiento de progreso, registro y prueba. Para obtener instrucciones de instalación, consulte [Instalación de la herramienta de migración de datos](../../../tools/data-migration-tool/install.md). Considere la posibilidad de explorar o contribuir al [Repositorio de migración de datos](https://github.com/magento/data-migration-tool).

El [Code Migration Toolkit](https://github.com/magento-commerce/code-migration) ayuda a transferir las extensiones y personalizaciones de almacén de Magento 1.x existentes a Magento 2.x. La interfaz de línea de comandos incluye secuencias de comandos para convertir módulos y diseños de Magento 1.x.
