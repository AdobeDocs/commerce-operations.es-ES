---
title: 'ACSD-67643: entradas duplicadas creadas durante actualizaciones programadas en entornos de categoría anidados'
description: Aplique el parche ACSD-67643 para corregir el problema de Adobe Commerce en el que se crean entradas duplicadas durante las actualizaciones programadas en entornos con un alto número de categorías anidadas.
feature: Catalog Management
role: Admin, Developer
type: Troubleshooting
source-git-commit: 62cb0633c9368e304914afe31bfd91c771f2f7e1
workflow-type: tm+mt
source-wordcount: '367'
ht-degree: 0%

---


# ACSD-67643: entradas duplicadas creadas durante actualizaciones programadas en entornos de categoría anidados

El parche ACSD-67643 corrige el problema en el que se crean entradas duplicadas durante las actualizaciones programadas en entornos con un alto número de categorías anidadas. Esta revisión está disponible cuando está instalado [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.71. El ID del parche es ACSD-67643. Este problema está programado para solucionarse en Adobe Commerce 2.4.9.

## Productos y versiones afectados

**El parche se ha creado para la versión de Adobe Commerce:**

* Adobe Commerce (todos los métodos de implementación) 2.4.8-p1

**Compatible con versiones de Adobe Commerce:**

* Adobe Commerce (todos los métodos de implementación) 2.4.8 - 2.4.8-p2

>[!NOTE]
>
>El parche podría ser aplicable a otras versiones con las nuevas versiones de [!DNL Quality Patches Tool]. Para comprobar si el parche es compatible con su versión de Adobe Commerce, actualice el paquete `magento/quality-patches` a la última versión y compruebe la compatibilidad en la página [[!DNL Quality Patches Tool]: buscar parches ](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html?lang=es). Utilice el ID de parche como palabra clave de búsqueda para localizar el parche.

## Problema

Las entradas duplicadas se producen al crear actualizaciones programadas para entornos que tienen un gran número de categorías anidadas.

<u>Pasos a seguir</u>:

1. **Generar datos de ejemplo:**
Usar un archivo de correcciones de rendimiento (por ejemplo: `small.xml`) con modificaciones:
   **[!UICONTROL Categories]**: *2.500*
   **[!UICONTROL Products]**: *250.000*

1. Ejecute el siguiente comando:

   ```bash
   bin/magento setup:performance:generate-fixtures var/performance-toolkit/profiles/ce/small.xml
   ```

1. Después de crear productos y categorías, asegúrese de que todas las categorías sean anclajes ejecutando:

   ```sql
   UPDATE catalog_category_entity_int SET value = 1 WHERE attribute_id = (SELECT attribute_id FROM eav_attribute WHERE attribute_code = 'is_anchor');
   ```

1. Ejecute un reindexado completo.
1. Inicie sesión en el servidor y abra la página **[!UICONTROL Categories]**.
1. Mueva *Categoría 2* a *Categoría 1* para aumentar el anidamiento del árbol.
1. Vaya a la categoría más anidada (por ejemplo: *Categoría 2.1.1*).
1. Cree una **actualización programada** y guarde la categoría.

<u>Resultados esperados</u>:

La categoría se ha guardado correctamente.

<u>Resultados reales</u>:

Se produce un *error 500* y se muestra el siguiente mensaje en los registros:

```
    Magento\Framework\DB\Adapter\DuplicateException:
    SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '6-165' for key 'PRIMARY', 
    query was: INSERT INTO `temp_category_descendants_68a35aea273fc` (`category_id`, `descendant_id`)
    SELECT `ce`.`entity_id` AS `category_id`, `ce2`.`entity_id` AS `descendant_id`
    FROM `catalog_category_entity` AS `ce`
    INNER JOIN `catalog_category_entity` AS `ce2` ON ce2.path LIKE CONCAT(ce.path, '/%')
```

## Aplicar el parche

Para aplicar parches individuales, utilice los siguientes vínculos según el método de implementación:

* Adobe Commerce o Magento Open Source local: [[!DNL Quality Patches Tool] > Uso](/help/tools/quality-patches-tool/usage.md) en la guía [!DNL Quality Patches Tool]
* Adobe Commerce en la infraestructura de la nube: [Actualizaciones y parches > Aplicar parches](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html?lang=es) en la guía Commerce en la infraestructura de la nube

## Lectura relacionada

Para obtener más información sobre [!DNL Quality Patches Tool], consulte:

* [[!DNL Quality Patches Tool]: herramienta de autoservicio para parches de calidad](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) en la guía Herramientas
