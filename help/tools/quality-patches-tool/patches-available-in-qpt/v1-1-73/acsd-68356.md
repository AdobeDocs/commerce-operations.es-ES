---
title: 'ACSD-68356: [!DNL GraphQL] la consulta del carro de compras devuelve una cantidad de descuento incorrecta para las cotizaciones virtuales'
description: Aplique el parche ACSD-68356 para corregir el problema de Adobe Commerce donde la consulta del carro de compras  [!DNL GraphQL] devuelve una cantidad de descuento incorrecta para las ofertas virtuales.
feature: Shopping Cart, GraphQL
role: Admin, Developer
type: Troubleshooting
source-git-commit: de86326804ad0d27b3580d9cede964a59bfa77fe
workflow-type: tm+mt
source-wordcount: '338'
ht-degree: 0%

---

# ACSD-68356: la consulta del carro de compras [!DNL GraphQL] devuelve una cantidad de descuento incorrecta para las cotizaciones virtuales

El parche ACSD-68356 corrige el problema en el que la consulta del carro de compras [!DNL GraphQL] devuelve una cantidad de descuento incorrecta para las cotizaciones virtuales. Esta revisión está disponible cuando está instalado [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.73. El ID del parche es ACSD-68356. Este problema está programado para solucionarse en Adobe Commerce 2.4.9.

## Productos y versiones afectados

**El parche se ha creado para la versión de Adobe Commerce:**

* Adobe Commerce (todos los métodos de implementación) 2.4.8-p2

**Compatible con versiones de Adobe Commerce:**

* Adobe Commerce (todos los métodos de implementación) 2.4.8 - 2.4.8-p3

>[!NOTE]
>
>El parche podría ser aplicable a otras versiones con las nuevas versiones de [!DNL Quality Patches Tool]. Para comprobar si el parche es compatible con su versión de Adobe Commerce, actualice el paquete `magento/quality-patches` a la última versión y compruebe la compatibilidad en la página [[!DNL Quality Patches Tool]: buscar parches ](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html). Utilice el ID de parche como palabra clave de búsqueda para localizar el parche.

## Problema

[!DNL GraphQL] consultas del carro de compras devuelven cantidades de descuento incorrectas para las ofertas virtuales, al aplicar descuentos a productos virtuales no elegibles.

<u>Pasos a seguir</u>:

1. Cree dos productos virtuales:
   1. SKU `virtual1`
   1. SKU `virtual2`
1. Crear una regla de precios de carro de compras:
   1. Configure para aplicar automáticamente, sin cupón.
   1. Acciones:
   1. Porcentaje de descuento en el precio del producto: 20 %.
   1. Solo se aplica a los elementos de carro donde el SKU es `virtual2`.
1. Agregue productos a una cita vacía nueva a través de la tienda:
   1. Agregue primero el SKU `virtual1`.
   1. Agregar SKU `virtual2` por segundo.
1. Obtener detalles del carro de compras mediante la siguiente consulta [!DNL GraphQL]:

   ```
   {
     cart(cart_id: "cart_id") {
       email
       itemsV2 {
         total_count
         items {
           uid
           prices {
             total_item_discount {
               value
             }
             price {
               value
             }
             discounts {
               label
               amount {
                 value
               }
             }
           }
           product {
             name
             sku
           }
           quantity
         },
         page_info {
             page_size
             current_page
             total_pages
         }
       }
       applied_coupons {
         code
       }
       prices {
         discounts {
           amount {
             value
           }
           applied_to
           label
         }
         grand_total {
           value
         }
       }
     }
   }
   ```

1. Seleccionar **[!UICONTROL cart]** > **[!UICONTROL items]** > **[!UICONTROL prices]** > **[!UICONTROL discounts]**.

<u>Resultados esperados</u>:

* El SKU `virtual1` no tiene ningún descuento enumerado en [!DNL GraphQL]
* El SKU `virtual2` tiene un descuento enumerado en [!DNL GraphQL]

<u>Resultados reales</u>:

* `virtual1` y `virtual2` muestran incorrectamente la misma cantidad de descuento en la respuesta [!DNL GraphQL].

## Aplicar el parche

Para aplicar parches individuales, utilice los siguientes vínculos según el método de implementación:

* Adobe Commerce o Magento Open Source local: [[!DNL Quality Patches Tool] > Uso](/help/tools/quality-patches-tool/usage.md) en la guía [!DNL Quality Patches Tool].
* Adobe Commerce en la infraestructura de la nube: [Actualizaciones y parches > Aplicar parches](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html) en la guía Commerce en la infraestructura de la nube.

## Lectura relacionada

Para obtener más información sobre [!DNL Quality Patches Tool], consulte:

* [[!DNL Quality Patches Tool]: herramienta de autoservicio para parches de calidad](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) en la guía Herramientas.
