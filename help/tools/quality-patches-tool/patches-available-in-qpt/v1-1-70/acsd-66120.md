---
title: 'ACSD-66120: [!DNL GraphQL] muestra porcentajes de descuento incorrectos y precios base cuando los precios de catálogo incluyen impuestos'
description: Aplique el parche ACSD-66120 para solucionar el problema de Adobe Commerce donde [!DNL GraphQL] muestra incorrectamente los porcentajes de descuento y los precios base cuando los precios de catálogo están configurados para incluir impuestos. Este problema provocaba discrepancias de redondeo, como mostrar un descuento del 19,99 % en lugar del 20 % esperado.
feature: GraphQL
role: Admin, Developer
type: Troubleshooting
source-git-commit: 237ec3fb5834b4130eee1ce121dfcd2655c851de
workflow-type: tm+mt
source-wordcount: '500'
ht-degree: 0%

---


# ACSD-66120: [!DNL GraphQL] muestra porcentajes de descuento incorrectos y precios base cuando los precios de catálogo incluyen impuestos

El parche ACSD-66120 corrige el problema por el cual [!DNL GraphQL] muestra incorrectamente los porcentajes de descuento y los precios base cuando los precios de catálogo están configurados para incluir impuestos. Este problema provocaba discrepancias de redondeo, como mostrar un descuento del 19,99 % en lugar del 20 % esperado. Esta revisión está disponible cuando está instalado [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.70. El ID del parche es ACSD-66120. Este problema está programado para solucionarse en Adobe Commerce 2.4.9.

## Productos y versiones afectados

**El parche se ha creado para la versión de Adobe Commerce:**

* Adobe Commerce (todos los métodos de implementación) 2.4.6-p9

**Compatible con versiones de Adobe Commerce:**

* Adobe Commerce (todos los métodos de implementación) 2.4.4 - 2.4.8-p2

>[!NOTE]
>
>El parche podría ser aplicable a otras versiones con las nuevas versiones de [!DNL Quality Patches Tool]. Para comprobar si el parche es compatible con su versión de Adobe Commerce, actualice el paquete `magento/quality-patches` a la última versión y compruebe la compatibilidad en la página [[!DNL Quality Patches Tool]: buscar parches ](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html). Utilice el ID de parche como palabra clave de búsqueda para localizar el parche.

## Problema

GraphQL muestra incorrectamente los porcentajes de descuento y los precios base cuando los precios de catálogo están configurados para incluir impuestos. Debido a errores de redondeo, el porcentaje de descuento se muestra como 19,99 % en lugar del 20 % configurado.

<u>Pasos a seguir</u>:

1. Vaya a **[!UICONTROL Stores]** > **[!UICONTROL Settings]** > **[!UICONTROL Configuration]** > **[!UICONTROL Catalog]** > **[!UICONTROL Catalog]** > **[!UICONTROL Price]**.
1. Establezca **[!UICONTROL Catalog Price Scope]** en *Sitio web*.
1. Vaya a **[!UICONTROL Stores]** > **[!UICONTROL Settings]** > **[!UICONTROL Configuration]** > **[!UICONTROL Sales]** > **[!UICONTROL Tax]** > **[!UICONTROL Calculation Settings]**.
   1. Establezca **[!UICONTROL Tax Calculation Method Based On]** en *Precio unitario*.
   1. Establezca **[!UICONTROL Catalog Prices]** en *Impuestos incluidos*.
   1. Establezca **[!UICONTROL Apply Discount On Prices]** en *Impuestos incluidos*.
1. Vaya a **[!UICONTROL Stores]** > **[!UICONTROL Settings]** > **[!UICONTROL Configuration]** > **[!UICONTROL Sales]** > **[!UICONTROL Tax]** > **[!UICONTROL Default Tax Destination Calculation]**.
   1. Establezca **[!UICONTROL Default Country]** en *Francia*.
1. Vaya a **[!UICONTROL Stores]** > **[!UICONTROL Tax Zones and Rates]** > **[!UICONTROL Add new Tax Rate]**.
   1. Escriba cualquier nombre en el campo **[!UICONTROL Tax Identifier]**.
   1. Escriba un asterisco (*) en el campo **[!UICONTROL Zip/Post Code]**.
   1. Establezca **[!UICONTROL Country]** en *Francia*.
   1. Escriba *20.000000* en el campo **[!UICONTROL Rate Percent]**.
   1. Haga clic en **[!UICONTROL Save]**.
1. Vaya a **[!UICONTROL Stores]** > **[!UICONTROL Tax Rules]** > **[!UICONTROL Add New Tax Rule]**.
   1. Escriba cualquier nombre en el campo **[!UICONTROL Name]**.
   1. Establezca **[!UICONTROL Tax Rate]** en la tarifa agregada en el paso anterior.
1. Vaya a **[!UICONTROL Catalog]** > **[!UICONTROL Products]** > **[!UICONTROL Add Product]**.
   1. Escriba *test* en el campo **[!UICONTROL Product Name]**.
   1. Escriba *test* en el campo **[!UICONTROL SKU]**.
   1. Escriba **82.65** en el campo **[!UICONTROL Price]**.
   1. Establezca **[!UICONTROL Tax Class]** en *Productos gravables*.
   1. Escriba *100* en el campo **[!UICONTROL Quantity]**.
   1. Haga clic en **[!UICONTROL Save]**.
1. Cambiar ámbito a *Vista de tienda predeterminada*.
   1. Anular el ajuste de **[!UICONTROL Use Default Value]** en Precio.
   1. Establezca **[!UICONTROL Price]** en *68.87*.
   1. Anular la configuración de **[!UICONTROL Use Default Value]** en la clase de impuesto.
   1. Establezca **[!UICONTROL Tax Class]** en *Bienes gravables*. 
   1. Haga clic en **[!UICONTROL Save]**.
1. Vaya a **[!UICONTROL Marketing]** > *[!UICONTROL Promotions]* > **[!UICONTROL Catalog Price Rule]** > **[!UICONTROL Add New Rule]**.
   1. Escriba cualquier nombre en el campo **[!UICONTROL Rule Name]**.
   1. Establezca **[!UICONTROL Active]** en *Sí*.
   1. Definir **[!UICONTROL Website]** en *Sitio web principal*.
   1. Establecer **[!UICONTROL Customer Groups]** en *todo*
   1. En **[!UICONTROL Actions]**, establezca **[!UICONTROL Apply]** en *Aplicar como porcentaje del original*.
   1. Escriba *20.000000* en el campo **[!UICONTROL Discount Amount]**.
   1. Haga clic en **[!UICONTROL Save]**.
1. Realice una reindexación completa:

```
$ bin/magento index:reindex
```

1. Realice la siguiente consulta [!DNL GraphQL] con **[!UICONTROL Store]**: *predeterminado* establecido en los encabezados:

```
query{
products(filter: {sku: {eq: "test"}}, sort: {name: ASC}) {
    items {
      name
      sku
      price_range {
        minimum_price {
          regular_price {
            value
            currency
          }
          final_price {
            value
            currency
          }
          discount {
            amount_off
            percent_off
          }
        }
        maximum_price {
          regular_price {
            value
            currency
          }
          final_price {
            value
            currency
          }
          discount {
            amount_off
            percent_off
          }
        }
      }
    }
  }
}
  
```

<u>Resultados esperados</u>:

El porcentaje de descuento debe coincidir con la regla del catálogo: 20%.

<u>Resultados reales</u>:

El porcentaje de descuento se muestra incorrectamente como 19,99%.

## Aplicar el parche

Para aplicar parches individuales, utilice los siguientes vínculos según el método de implementación:

* Adobe Commerce o Magento Open Source local: [[!DNL Quality Patches Tool] > Uso](/help/tools/quality-patches-tool/usage.md) en la guía [!DNL Quality Patches Tool].
* Adobe Commerce en la infraestructura de la nube: [Actualizaciones y parches > Aplicar parches](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html) en la guía Commerce en la infraestructura de la nube.

## Lectura relacionada

Para obtener más información sobre [!DNL Quality Patches Tool], consulte:

* [[!DNL Quality Patches Tool]: herramienta de autoservicio para parches de calidad](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) en la guía Herramientas.
